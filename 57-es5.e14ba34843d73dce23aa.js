function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],n=!0,r=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(s){r=!0,a=s}finally{try{n||null==c.return||c.return()}finally{if(r)throw a}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{IOBc:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("5HBU"),r=i("bTqV"),a=i("kmnG"),o=i("NFeN"),c=i("qFsG"),s=i("wZkO"),l=i("/t3+"),u=i("bSwM"),b=i("+0xr"),h=i("FKr1"),p=i("MutI"),m=i("fXoL"),d=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=m.Pb({type:e}),e.\u0275inj=m.Ob({factory:function(t){return new(t||e)},imports:[[n.a,r.c,a.e,o.b,c.c,s.c,l.b,u.b,h.t,p.c,b.k]]}),e}()},ZVYM:function(e,t,i){"use strict";i.r(t);var n=i("tyNb"),r=i("STbY"),a=i("/1cH"),o=i("iadO"),c=i("bTqV"),s=i("7EHt"),l=i("kmnG"),u=i("NFeN"),b=i("Qu3c"),h=i("qFsG"),p=i("wZkO"),m=i("d3UM"),d=i("QibW"),f=i("0IaG"),v=i("/t3+"),g=i("bSwM"),y=i("M9IT"),x=i("xHqg"),S=i("A5z7"),_=i("bv9b"),k=i("XhcP"),C=i("FKr1"),w=i("1jcm"),D=i("+0xr"),A=i("Dh3D"),W=i("IOBc"),P=i("212X"),X=i("5HBU"),I=i("LPQX"),L=i("fXoL"),O=i("ofXK");function R(e,t){1&e&&L.Sb(0,"router-outlet")}var T,N,j=((T=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||T)},T.\u0275cmp=L.Lb({type:T,selectors:[["simba"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&L.Jc(0,R,1,0,"router-outlet",0),2&e&&L.pc("ngIf",!0)},directives:[O.t,n.l],styles:[""]}),T),F=i("XNiG"),B=i("1G5W"),V=i("HX77"),H=i("2Vo4"),M=i("jD4G"),z=i("tk/3"),E=i("qXBG"),G=((N=function(){function e(t,i,n){_classCallCheck(this,e),this._httpClient=t,this.authService=i,this.datePipe=n,this.defaultSearch={formSearch:{pay_party:null,issue_party:null,customer:null,agent:113,voyage:null,payment_center:null,date_from:"11/01/2022",date_to:"11/30/2022"}},this.headerImp=["No","Vessel & Voyage","Eta","Owner","Daily","BL","20","40","OF PP","OF CL","Total","Com 20","Com 40","Total Com","Total USD","CL SGD","Paid SGD","Total SGD"],this.headerExp=["No","Vessel & Voyage","Etd","Owner","Exrate","BL","20","40","OF PP","OF CL","BAF","ECRS","LSS","DG","Total","Paid OF","Paid BAF","Com 20","Com 40","Total Com","Total USD","CL SGD","Paid SGD","Total SGD"],this.onDataChanged=new H.a([]),this.onDataItemChanged=new H.a([]),this.onShipmentChanged=new H.a({}),this.onSearchTextChanged=new F.a}return _createClass(e,[{key:"resolve",value:function(e){var t=this;return e&&(this.authService.routerData=e),this.currenSearch||(this.currenSearch=JSON.parse(JSON.stringify(this.defaultSearch))),new Promise((function(e,i){Promise.all([t.getData(),t.getItemData(),t.getSelShipmentSimba(t.currenSearch.formSearch)]).then((function(i){_slicedToArray(i,1)[0],t.onSearchTextChanged.subscribe((function(e){t.searchText=e;var i=t.shipmentAddInfo.slice();t.searchText&&""!==t.searchText&&(i=M.a.filterArrayByString(i,t.searchText));var n=t.shipmentImpAddInfo.slice();t.searchText&&""!==t.searchText&&(n=M.a.filterArrayByString(n,t.searchText)),t.onShipmentChanged.next({import:n,export:i})})),e()}),i)}))}},{key:"getData",value:function(){var e=this,t={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((function(i,n){e._httpClient.get(e.authService.apiUrl+"/sel/shipment/data",t).subscribe((function(t){e.dataCustomer=t[0],e.dataSupplier=t[1],e.users=t[3],e.onDataChanged.next(t),i(t)}),n)}))}},{key:"getItemData",value:function(){var e=this,t={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((function(i,n){e._httpClient.get(e.authService.apiUrl+"/sel/book/book",t).subscribe((function(t){e.agent=t.agent,e.commodity=t.commodity,e.packageType=t.packageType,e.price=t.price,e.currency=t.currency,e.country=t.country,e.depot=t.depot,e.onDataItemChanged.next(t),i(t)}),n)}))}},{key:"getSelShipmentSimba",value:function(e){var t=this;this.dateFrom=e.date_from?e.date_from:null,this.dateTo=e.date_to?e.date_to:null;var i={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((function(n,r){t._httpClient.post(t.authService.apiUrl+"/sel/shipment/soa-agent",e,i).subscribe((function(e){console.log(e),t.shipment=e.export.shipment,t.shipmentAddInfo=e.export.shipmentAddInfo,t.sptPrice=e.export.price,t.sptVoyage=e.export.voyage;var i=t.shipmentAddInfo.slice();t.searchText&&""!==t.searchText&&(i=M.a.filterArrayByString(i,t.searchText)),t.shipmentImp=e.import.shipment,t.shipmentImpAddInfo=e.import.shipmentAddInfo,t.sptPriceImp=e.import.price,t.sptVoyageImp=e.import.voyage;var r=t.shipmentImpAddInfo.slice();t.searchText&&""!==t.searchText&&(r=M.a.filterArrayByString(r,t.searchText)),t.onShipmentChanged.next({import:r,export:i}),n(e)}),r)}))}},{key:"createSelRevenue",value:function(e){var t=this,i={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((function(n,r){t._httpClient.post(t.authService.apiUrl+"/sel/revenue",e,i).subscribe((function(e){n(e)}),r)}))}},{key:"createSelCost",value:function(e){var t=this,i={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((function(n,r){t._httpClient.post(t.authService.apiUrl+"/sel/cost",e,i).subscribe((function(e){n(e)}),r)}))}},{key:"updateSelRevenue",value:function(e){var t=this,i={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((function(n,r){t._httpClient.put(t.authService.apiUrl+"/sel/revenue",e,i).subscribe((function(e){n(e)}),r)}))}},{key:"updateSelCost",value:function(e){var t=this,i={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((function(n,r){t._httpClient.put(t.authService.apiUrl+"/sel/cost",e,i).subscribe((function(e){n(e)}),r)}))}},{key:"updateMultiShipmentItem",value:function(e){var t=this,i={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((function(n,r){t._httpClient.put(t.authService.apiUrl+"/sel/shipment/multi-item",e,i).subscribe((function(e){n(e)}),r)}))}}]),e}()).\u0275fac=function(e){return new(e||N)(L.bc(z.a),L.bc(E.a),L.bc(O.f))},N.\u0275prov=L.Nb({token:N,factory:N.\u0275fac}),N),q=i("vI/F"),J=i("B9zo"),U=i("0JVi"),K=i("XiUz"),Y=i("znSr");function $(e,t){if(1&e){var i=L.Yb();L.Xb(0,"button",12),L.fc("click",(function(e){L.Bc(i);var t=L.jc();return e.stopPropagation(),t.changeScreen(!0)})),L.Xb(1,"mat-icon"),L.Lc(2,"flip_to_front"),L.Wb(),L.Wb()}}function Q(e,t){if(1&e){var i=L.Yb();L.Xb(0,"button",12),L.fc("click",(function(e){L.Bc(i);var t=L.jc();return e.stopPropagation(),t.changeScreen(!1)})),L.Xb(1,"mat-icon"),L.Lc(2,"flip_to_back"),L.Wb(),L.Wb()}}var Z,ee=((Z=function(){function e(t,i){_classCallCheck(this,e),this.authService=t,this._fuseConfigService=i,this.fullScreen=!1,this.toggleSidebar=new L.o,this.showHideBar=new L.o,this.refreshPage=new L.o,this.searchFilter=new L.o,this._unsubscribeAll=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}},{key:"changeScreen",value:function(e){this.fullScreen=e,this.authService.changeScreen.next(e),this._fuseConfigService.config=this.fullScreen?{layout:{navbar:{hidden:!0},toolbar:{hidden:!0},footer:{hidden:!0},sidepanel:{hidden:!0}}}:{layout:{navbar:{hidden:!1},toolbar:{hidden:!1},footer:{hidden:!0},sidepanel:{hidden:!0}}}}}]),e}()).\u0275fac=function(e){return new(e||Z)(L.Rb(E.a),L.Rb(U.b))},Z.\u0275cmp=L.Lb({type:Z,selectors:[["simba-header"]],inputs:{sidebarName:"sidebarName",searchText:"searchText"},outputs:{toggleSidebar:"toggleSidebar",showHideBar:"showHideBar",refreshPage:"refreshPage",searchFilter:"searchFilter"},decls:29,vars:4,consts:[[1,"p-0","mat-elevation-z1"],["fxFlex","","fxFill","","fxLayout","row","fxLayoutAlign","start center"],["fxFlex","1 0 auto","fxLayout","row","fxLayoutAlign","start center"],[1,"px-8","px-md-16"],["mat-icon-button","","fxHide.gt-sm","","fxFlex","10","fxFlex.gt-sm","0",1,"sidebar-toggle","ml-12","mr-12",3,"click"],["mat-icon-button","","fxHide","","fxShow.gt-sm","","fxFlex","10","fxFlex.gt-sm","0",1,"sidebar-toggle","ml-12","mr-12",3,"click"],["mat-icon-button","","routerLinkActive","accent-600-fg",1,"quick-panel-toggle-button",3,"routerLink"],["fxHide","","fxShow.gt-sm",""],["fxShow","","fxHide.gt-sm",""],["fxFlex","0 1 auto","fxLayout","row","fxLayoutAlign","start center",1,""],[1,"toolbar-separator"],["mat-icon-button","","class","ml-8 mr-8",3,"click",4,"ngIf"],["mat-icon-button","",1,"ml-8","mr-8",3,"click"]],template:function(e,t){1&e&&(L.Xb(0,"mat-toolbar",0),L.Xb(1,"div",1),L.Xb(2,"div",2),L.Xb(3,"div",3),L.Xb(4,"button",4),L.fc("click",(function(e){return t.toggleSidebar.emit(t.sidebarName)})),L.Xb(5,"mat-icon"),L.Lc(6,"menu"),L.Wb(),L.Wb(),L.Xb(7,"button",5),L.fc("click",(function(e){return t.showHideBar.emit()})),L.Xb(8,"mat-icon"),L.Lc(9,"menu"),L.Wb(),L.Wb(),L.Wb(),L.Xb(10,"button",6),L.Xb(11,"span",7),L.Lc(12,"Inward"),L.Wb(),L.Xb(13,"mat-icon",8),L.Lc(14,"equalizer"),L.Wb(),L.Wb(),L.Xb(15,"button",6),L.Xb(16,"span",7),L.Lc(17,"Outward"),L.Wb(),L.Xb(18,"mat-icon",8),L.Lc(19,"equalizer"),L.Wb(),L.Wb(),L.Wb(),L.Xb(20,"div",9),L.Sb(21,"div",10),L.Jc(22,$,3,0,"button",11),L.Jc(23,Q,3,0,"button",11),L.Sb(24,"div",10),L.Xb(25,"button",12),L.fc("click",(function(e){return t.toggleSidebar.emit("simba-setting")})),L.Xb(26,"mat-icon"),L.Lc(27,"settings"),L.Wb(),L.Wb(),L.Sb(28,"div",10),L.Wb(),L.Wb(),L.Wb()),2&e&&(L.Db(10),L.pc("routerLink","/apps/sel-admin/simba/import"),L.Db(5),L.pc("routerLink","/apps/sel-admin/simba/export"),L.Db(7),L.pc("ngIf",!t.fullScreen),L.Db(1),L.pc("ngIf",t.fullScreen))},directives:[v.a,K.b,K.e,K.d,K.c,c.b,Y.b,u.a,n.i,n.h,O.t],styles:["simba-header{position:relative;display:-webkit-box;display:flex;-webkit-box-flex:0;flex:0 0 auto;z-index:4}simba-header.below{z-index:2}simba-header .mat-toolbar{position:relative;background:#fff!important;color:inherit!important}simba-header .logo{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}simba-header .logo .logo-icon{width:38px}simba-header .chat-panel-toggle-button,simba-header .language-button,simba-header .quick-panel-toggle-button,simba-header .user-button,simba-header fuse-search-bar{min-width:64px;height:64px}@media screen and (max-width:599px){simba-header .chat-panel-toggle-button,simba-header .language-button,simba-header .quick-panel-toggle-button,simba-header .user-button,simba-header fuse-search-bar{height:56px}}simba-header .navbar-toggle-button{min-width:56px;height:56px}simba-header .toolbar-separator{height:64px;width:1px;background:#e6e6e6}@media screen and (max-width:599px){simba-header .toolbar-separator{height:56px}}"],encapsulation:2}),Z),te=i("3Pt+"),ie=i("0Zc1"),ne=i("vxfF");function re(e,t){if(1&e&&(L.Xb(0,"th",7),L.Xb(1,"mat-form-field",8),L.Sb(2,"input",9),L.Wb(),L.Wb()),2&e){var i=t.index,n=L.jc();L.Ic("top",n.inverseOfTranslation),L.Db(2),L.pc("formControlName",i)}}function ae(e,t){if(1&e&&(L.Vb(0),L.Xb(1,"td",7),L.Lc(2),L.Wb(),L.Ub()),2&e){var i=t.$implicit;L.Db(2),L.Mc(i)}}function oe(e,t){if(1&e&&(L.Vb(0),L.Xb(1,"tr"),L.Jc(2,ae,3,1,"ng-container",10),L.Wb(),L.Ub()),2&e){var i=t.$implicit;L.Db(2),L.pc("ngForOf",i)}}var ce,se=((ce=function(){function e(t,i,n,r){_classCallCheck(this,e),this.authService=t,this.datePipe=i,this.formBuilder=n,this.commonService=r,this.form=this.formBuilder.group({header:this.formBuilder.array([])})}return _createClass(e,[{key:"ngOnInit",value:function(){this.getHeader()}},{key:"ngOnChanges",value:function(e){e.data&&(e.data.currentValue||null==e.data.currentValue)&&(this.data=e.data.currentValue)}},{key:"addHeader",value:function(){this.headerAdd.push(new te.e(""))}},{key:"removeHeader",value:function(e){this.headerAdd.removeAt(e)}},{key:"getHeader",value:function(){var e=this;this.data[0]&&this.data[0].length==this.header.length&&this.header.map((function(t){e.headerAdd.push(new te.e(t))}))}},{key:"headerAdd",get:function(){return this.form.get("header")}},{key:"inverseOfTranslation",get:function(){return this.viewPort&&this.viewPort._renderedContentOffset?"-".concat(this.viewPort._renderedContentOffset,"px"):"-0px"}}]),e}()).\u0275fac=function(e){return new(e||ce)(L.Rb(E.a),L.Rb(O.f),L.Rb(te.d),L.Rb(ie.a))},ce.\u0275cmp=L.Lb({type:ce,selectors:[["simba-import-excel-table"]],viewQuery:function(e,t){var i;1&e&&L.Sc(ne.e,!0),2&e&&L.wc(i=L.gc())&&(t.viewPort=i.first)},inputs:{height:"height",data:"data",header:"header"},features:[L.Bb()],decls:10,vars:5,consts:[["name","form","fxLayout","column",1,"content-view",3,"formGroup","keydown.enter"],["formDirective","ngForm"],["itemSize","34",1,"h-100-p"],[1,"simple","simba-excel-table"],["formArrayName","header"],["class","",3,"top",4,"ngFor","ngForOf"],[4,"cdkVirtualFor","cdkVirtualForOf"],[1,""],[1,"my-form-field"],["matInput","","inputCheck","","type","text",2,"font-size","12px",3,"formControlName"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(L.Xb(0,"form",0,1),L.fc("keydown.enter",(function(e){return"TEXTAREA"==e.target.tagName})),L.Xb(2,"cdk-virtual-scroll-viewport",2),L.Xb(3,"table",3),L.Xb(4,"thead"),L.Xb(5,"tr"),L.Vb(6,4),L.Jc(7,re,3,3,"th",5),L.Ub(),L.Wb(),L.Wb(),L.Xb(8,"tbody"),L.Jc(9,oe,3,1,"ng-container",6),L.Wb(),L.Wb(),L.Wb(),L.Wb()),2&e&&(L.Ic("height",t.height-136,"px"),L.pc("formGroup",t.form),L.Db(7),L.pc("ngForOf",t.form.value.header),L.Db(2),L.pc("cdkVirtualForOf",t.data))},directives:[te.A,te.q,K.d,te.h,ne.e,ne.a,te.c,O.s,ne.d,l.c,h.b,te.b,te.p,te.g],styles:["simba-import-excel-table .content-view{overflow:auto}simba-import-excel-table .content-view .width-form{width:1400px}@media screen and (min-width:960px)and (max-width:1279px){simba-import-excel-table .content-view .width-form{width:100%}}simba-import-excel-table .content-view .rev-color{background-color:#b3e5fc}simba-import-excel-table .content-view .cost-color{background-color:#ffcf9c}simba-import-excel-table .content-view .simba-excel-table{font-size:12px}simba-import-excel-table .content-view .simba-excel-table .border-right{border-right:1px solid rgba(0,0,0,.12)}simba-import-excel-table .content-view .simba-excel-table td,simba-import-excel-table .content-view .simba-excel-table th{padding:8px!important;white-space:nowrap}simba-import-excel-table .content-view .simba-excel-table thead th{position:sticky;position:-webkit-sticky;top:0;background:#fff;z-index:10}simba-import-excel-table .content-view .simba-excel-table .mat-standard-chip{font-size:12px;padding:4px;border-radius:10px;min-height:24px}simba-import-excel-table .content-view .simba-excel-table .sticky-left-col1{position:sticky;position:-webkit-sticky;left:0;background-color:#fff;z-index:20}simba-import-excel-table .content-view .simba-excel-table .sticky-left-col2{position:sticky;position:-webkit-sticky;left:40px;background-color:#fff;z-index:20}simba-import-excel-table .content-view .simba-excel-table .sticky-right-col{min-width:40px;position:sticky;position:-webkit-sticky;right:0;background-color:#fff}simba-import-excel-table .content-view .simba-excel-table .my-form-field .mat-form-field-wrapper{margin-bottom:-1.25em}simba-import-excel-table .content-view .simba-excel-table .my-form-field .mat-form-field-infix{margin-top:-1.25em;width:100%!important}"],encapsulation:2}),ce);function le(e,t){if(1&e&&(L.Xb(0,"span"),L.Lc(1),L.kc(2,"number"),L.Wb()),2&e){var i=L.jc().$implicit;L.Db(1),L.Mc(L.mc(2,1,i.volume*(i.amount+i.tax_amount)*i.ex_rate,"1.0-0"))}}function ue(e,t){if(1&e&&(L.Xb(0,"span"),L.Lc(1),L.kc(2,"number"),L.Wb()),2&e){var i=L.jc().$implicit;L.Db(1),L.Mc(L.mc(2,1,i.volume*(i.amount+i.tax_amount)*i.ex_rate,"1.0-0"))}}function be(e,t){if(1&e){var i=L.Yb();L.Xb(0,"mat-icon",13),L.fc("click",(function(e){L.Bc(i);var t=L.jc().$implicit,n=L.jc();return e.stopPropagation(),n.savePrice.emit(t)})),L.Lc(1,"save"),L.Wb()}}var he=function(e){return{"red-A100-bg":e}},pe=function(e){return{"red-A700-fg":e}},me=function(e,t){return{"red-A700-fg":e,"rev-color":t}},de=function(e,t){return{"red-A700-fg":e,"cost-color":t}},fe=function(e,t){return{"rev-color":e,"cost-color":t}};function ve(e,t){if(1&e){var i=L.Yb();L.Vb(0),L.Xb(1,"tr",15),L.Xb(2,"td",16),L.Lc(3),L.Wb(),L.Xb(4,"td",17),L.Lc(5),L.Wb(),L.Xb(6,"td",18),L.fc("click",(function(e){L.Bc(i);var n=t.$implicit;return L.jc().filterBy("bill",n.bill)})),L.Lc(7),L.Wb(),L.Xb(8,"td",19),L.fc("click",(function(e){L.Bc(i);var n=t.$implicit;return L.jc().filterBy("party",n.partner_short_name)})),L.Lc(9),L.Wb(),L.Xb(10,"td",20),L.fc("click",(function(e){L.Bc(i);var n=t.$implicit;return L.jc().filterBy("price",n.price_code)})),L.Lc(11),L.Wb(),L.Xb(12,"td",21),L.Lc(13),L.Wb(),L.Xb(14,"td",21),L.Lc(15),L.Wb(),L.Xb(16,"td",22),L.Lc(17),L.kc(18,"number"),L.Wb(),L.Xb(19,"td",23),L.Lc(20),L.Wb(),L.Xb(21,"td",24),L.Lc(22),L.kc(23,"number"),L.Wb(),L.Xb(24,"td",21),L.Lc(25),L.Wb(),L.Xb(26,"td",21),L.Lc(27),L.kc(28,"number"),L.Wb(),L.Xb(29,"td",22),L.Jc(30,le,3,4,"span",25),L.Wb(),L.Xb(31,"td",22),L.Jc(32,ue,3,4,"span",25),L.Wb(),L.Xb(33,"td",26),L.Lc(34),L.Wb(),L.Xb(35,"td",27),L.Lc(36),L.Wb(),L.Xb(37,"td",28),L.Lc(38),L.Wb(),L.Xb(39,"td",29),L.Jc(40,be,2,0,"mat-icon",30),L.Wb(),L.Wb(),L.Ub()}if(2&e){var n=t.$implicit,r=t.index;L.Db(1),L.pc("ngClass",L.rc(36,he,n.amount_shipment&&n.amount!=n.amount_shipment.amount)),L.Db(2),L.Mc(r+1),L.Db(2),L.Mc(n.code),L.Db(2),L.Mc(n.bill),L.Db(1),L.pc("matTooltip",n.partner_name)("matTooltipPosition","right"),L.Db(1),L.Mc(n.partner_short_name),L.Db(1),L.pc("matTooltip",n.price_name)("matTooltipPosition","right"),L.Db(1),L.Mc(n.price_code),L.Db(2),L.Mc(n.unit_code),L.Db(2),L.Mc(n.volume),L.Db(1),L.pc("ngClass",L.rc(38,pe,n.amount<0)),L.Db(1),L.Mc(L.mc(18,27,n.amount,"1.2-2")),L.Db(3),L.Mc(n.tax),L.Db(2),L.Mc(L.mc(23,30,n.tax_amount,"1.2-2")),L.Db(3),L.Mc(n.currency_code),L.Db(2),L.Mc(L.mc(28,33,n.ex_rate,"1.0-0")),L.Db(2),L.pc("ngClass",L.sc(40,me,n.amount<0,"Revenue"==n.type_name)),L.Db(1),L.pc("ngIf","Revenue"==n.type_name),L.Db(1),L.pc("ngClass",L.sc(43,de,n.amount<0,"Cost"==n.type_name)),L.Db(1),L.pc("ngIf","Cost"==n.type_name),L.Db(2),L.Mc(n.country_name),L.Db(2),L.Mc(null==n.amount_shipment?null:n.amount_shipment.amount),L.Db(1),L.pc("ngClass",L.sc(46,fe,"Revenue"==n.type_name,"Cost"==n.type_name)),L.Db(1),L.Mc(n.type_name),L.Db(2),L.pc("ngIf",n.code&&!n.amount_shipment)}}var ge,ye=((ge=function(){function e(t,i,n,r){_classCallCheck(this,e),this.authService=t,this.datePipe=i,this.formBuilder=n,this.commonService=r,this.savePrice=new L.o,this.saveAllPrice=new L.o}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"inverseOfTranslation1",get:function(){return this.viewPort&&this.viewPort._renderedContentOffset?"-".concat(this.viewPort._renderedContentOffset,"px"):"-0px"}}]),e}()).\u0275fac=function(e){return new(e||ge)(L.Rb(E.a),L.Rb(O.f),L.Rb(te.d),L.Rb(ie.a))},ge.\u0275cmp=L.Lb({type:ge,selectors:[["simba-import-price-table"]],viewQuery:function(e,t){var i;1&e&&L.Sc(ne.e,!0),2&e&&L.wc(i=L.gc())&&(t.viewPort=i.first)},inputs:{height:"height",dataPrice:"dataPrice"},outputs:{savePrice:"savePrice",saveAllPrice:"saveAllPrice"},decls:44,vars:39,consts:[["fxLayout","column",1,"content-view"],["itemSize","34",1,"h-100-p"],[1,"simple","simba-price-table"],[1,"sticky-header-1","w-40","text-left","sticky-left-col1",2,"z-index","25"],[1,"sticky-header-1","w-160","sticky-left-col2",2,"z-index","25"],[1,"sticky-header-1","w-160"],[1,"sticky-header-1","w-100"],[1,"sticky-header-1","w-140"],[1,"sticky-header-1","w-60"],[1,"sticky-header-1","w-120","text-right"],[1,"sticky-header-1","w-120","text-right","rev-color"],[1,"sticky-header-1","w-120","text-right","cost-color"],[1,"sticky-header-1","w-40","sticky-right-col"],["color","accent",1,"cursor-pointer",3,"click"],[4,"cdkVirtualFor","cdkVirtualForOf"],[3,"ngClass"],[1,"w-40","text-center","sticky-left-col1"],[1,"w-160","sticky-left-col2"],[1,"w-160",3,"click"],[1,"w-100",3,"matTooltip","matTooltipPosition","click"],[1,"w-140",3,"matTooltip","matTooltipPosition","click"],[1,"w-60"],[1,"w-120","text-right",3,"ngClass"],[1,"w-60","text-center"],[1,"w-100","text-right"],[4,"ngIf"],[1,"w-140"],[1,"w-120","text-right"],[1,"w-100",3,"ngClass"],[1,"sticky-right-col"],["class","cursor-pointer","color","accent",3,"click",4,"ngIf"]],template:function(e,t){1&e&&(L.Xb(0,"div",0),L.Xb(1,"cdk-virtual-scroll-viewport",1),L.Xb(2,"table",2),L.Xb(3,"thead"),L.Xb(4,"tr"),L.Xb(5,"th",3),L.Lc(6," No "),L.Wb(),L.Xb(7,"th",4),L.Lc(8,"Code"),L.Wb(),L.Xb(9,"th",5),L.Lc(10,"Bill"),L.Wb(),L.Xb(11,"th",6),L.Lc(12,"Party"),L.Wb(),L.Xb(13,"th",7),L.Lc(14,"Price"),L.Wb(),L.Xb(15,"th",8),L.Lc(16,"Unit"),L.Wb(),L.Xb(17,"th",8),L.Lc(18,"Volume"),L.Wb(),L.Xb(19,"th",9),L.Lc(20,"Amount"),L.Wb(),L.Xb(21,"th",8),L.Lc(22,"Tax"),L.Wb(),L.Xb(23,"th",6),L.Lc(24,"Tax Amount"),L.Wb(),L.Xb(25,"th",8),L.Lc(26,"Currency"),L.Wb(),L.Xb(27,"th",8),L.Lc(28,"Ex rate"),L.Wb(),L.Xb(29,"th",10),L.Lc(30,"Total Revenue"),L.Wb(),L.Xb(31,"th",11),L.Lc(32,"Total Cost"),L.Wb(),L.Xb(33,"th",7),L.Lc(34,"Payment center"),L.Wb(),L.Xb(35,"th",9),L.Lc(36,"Spt Amount"),L.Wb(),L.Xb(37,"th",6),L.Lc(38,"Type"),L.Wb(),L.Xb(39,"th",12),L.Xb(40,"mat-icon",13),L.fc("click",(function(e){return e.stopPropagation(),t.saveAllPrice.emit()})),L.Lc(41,"save"),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Xb(42,"tbody"),L.Jc(43,ve,41,49,"ng-container",14),L.Wb(),L.Wb(),L.Wb(),L.Wb()),2&e&&(L.Ic("height",t.height-136,"px"),L.Db(5),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(4),L.pc("cdkVirtualForOf",t.dataPrice))},directives:[K.d,ne.e,ne.a,u.a,ne.d,O.q,Y.a,b.a,O.t],pipes:[O.g],styles:["simba-import-price-table .content-view{overflow:auto}simba-import-price-table .content-view .width-form{width:1400px}@media screen and (min-width:960px)and (max-width:1279px){simba-import-price-table .content-view .width-form{width:100%}}simba-import-price-table .content-view .rev-color{background-color:#b3e5fc}simba-import-price-table .content-view .cost-color{background-color:#ffcf9c}simba-import-price-table .content-view .simba-price-table{font-size:12px}simba-import-price-table .content-view .simba-price-table .border-right{border-right:1px solid rgba(0,0,0,.12)}simba-import-price-table .content-view .simba-price-table td,simba-import-price-table .content-view .simba-price-table th{padding:8px!important;white-space:nowrap}simba-import-price-table .content-view .simba-price-table thead th.sticky-header-1{position:sticky;position:-webkit-sticky;top:0;background:#fff;z-index:10}simba-import-price-table .content-view .simba-price-table thead th.sticky-header-2{position:sticky;position:-webkit-sticky;top:32px;background:#fff;z-index:10}simba-import-price-table .content-view .simba-price-table .mat-standard-chip{font-size:12px;padding:4px;border-radius:10px;min-height:24px}simba-import-price-table .content-view .simba-price-table .sticky-left-col1{position:sticky;position:-webkit-sticky;left:0;background-color:#fff;z-index:20}simba-import-price-table .content-view .simba-price-table .sticky-left-col2{position:sticky;position:-webkit-sticky;left:40px;background-color:#fff;z-index:20}simba-import-price-table .content-view .simba-price-table .sticky-right-col{min-width:40px;position:sticky;position:-webkit-sticky;right:0;background-color:#fff}simba-import-price-table .content-view .simba-price-table .my-form-field .mat-form-field-wrapper{margin-bottom:-1.25em}simba-import-price-table .content-view .simba-price-table .my-form-field .mat-form-field-infix{margin-top:-1.25em}"],encapsulation:2}),ge),xe=["googleSheet"];function Se(e,t){1&e&&L.Lc(0,"Get data")}function _e(e,t){if(1&e){var i=L.Yb();L.Xb(0,"button",11),L.fc("click",(function(e){return L.Bc(i),L.jc().getHeader()})),L.Lc(1," Get Header "),L.Wb()}}function ke(e,t){1&e&&L.Lc(0,"Price")}var Ce,we=function(e){return{hide:e}},De=((Ce=function(){function e(t,i,n,r,a){_classCallCheck(this,e),this.authService=t,this.datePipe=i,this.formBuilder=n,this.googleApiService=r,this.commonService=a,this.getPrice=new L.o,this.savePrice=new L.o,this.saveAllPrice=new L.o,this._unsubscribeAll=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.googleApiService.onGapiChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.auth=t,e.attachSignin()}))}},{key:"ngOnDestroy",value:function(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}},{key:"attachSignin",value:function(){var e=this;this.auth.attachClickHandler(this.googleSheet._elementRef.nativeElement,{},(function(t){e.token=e.googleApiService.token=t.getAuthResponse().access_token,e.googleApiService.createPicker()}),(function(e){alert("ERROR"),console.error(e)}))}},{key:"openPicker",value:function(){this.googleApiService.createPicker()}}]),e}()).\u0275fac=function(e){return new(e||Ce)(L.Rb(E.a),L.Rb(O.f),L.Rb(te.d),L.Rb(q.a),L.Rb(ie.a))},Ce.\u0275cmp=L.Lb({type:Ce,selectors:[["simba-import-data"]],viewQuery:function(e,t){var i;1&e&&L.Sc(xe,!0),2&e&&L.wc(i=L.gc())&&(t.googleSheet=i.first)},inputs:{height:"height",data:"data",dataPrice:"dataPrice",header:"header"},outputs:{getPrice:"getPrice",savePrice:"savePrice",saveAllPrice:"saveAllPrice"},decls:22,vars:13,consts:[["fxLayout","column"],["fxLayout","row wrap"],["fxFlex","100",3,"linear"],["stepper",""],["matStepLabel",""],[3,"height","data","header"],["fxLayout","row"],["mat-raised-button","","type","button","color","accent","id","googleSheet",1,"mr-8",3,"ngClass"],["googleSheet",""],["mat-raised-button","","type","button","color","accent","id","googleSheet2",1,"mr-8",3,"ngClass","click"],["class","mr-8","mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",1,"mr-8",3,"click"],[3,"height","dataPrice","savePrice","saveAllPrice"],["mat-raised-button","","matStepperPrevious","","type","button","color","accent",1,"mr-8"]],template:function(e,t){if(1&e){var i=L.Yb();L.Xb(0,"div",0),L.Xb(1,"div",1),L.Xb(2,"mat-horizontal-stepper",2,3),L.Xb(4,"mat-step"),L.Jc(5,Se,1,0,"ng-template",4),L.Sb(6,"simba-import-excel-table",5),L.Xb(7,"div",6),L.Xb(8,"button",7,8),L.Lc(10," Get Data "),L.Wb(),L.Xb(11,"button",9),L.fc("click",(function(e){return t.openPicker()})),L.Lc(12," Get Data "),L.Wb(),L.Jc(13,_e,2,0,"button",10),L.Xb(14,"button",11),L.fc("click",(function(e){L.Bc(i);var n=L.xc(3);return t.getPrice.emit(n)})),L.Lc(15," Get Price "),L.Wb(),L.Wb(),L.Wb(),L.Xb(16,"mat-step"),L.Jc(17,ke,1,0,"ng-template",4),L.Xb(18,"simba-import-price-table",12),L.fc("savePrice",(function(e){return t.savePrice.emit(e)}))("saveAllPrice",(function(e){return t.saveAllPrice.emit(e)})),L.Wb(),L.Xb(19,"div",6),L.Xb(20,"button",13),L.Lc(21," Previous "),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb()}2&e&&(L.Db(2),L.pc("linear",!0),L.Db(4),L.pc("height",t.height)("data",t.data)("header",t.header),L.Db(2),L.pc("ngClass",L.rc(9,we,t.token)),L.Db(3),L.pc("ngClass",L.rc(11,we,!t.token)),L.Db(2),L.pc("ngIf",t.data.length>0),L.Db(5),L.pc("height",t.height)("dataPrice",t.dataPrice))},directives:[K.d,x.a,K.b,x.b,x.c,se,c.b,O.q,Y.a,O.t,ye,x.f],styles:[""],encapsulation:2}),Ce),Ae=i("fE3o"),We=i("JX91"),Pe=i("lJxs"),Xe=i("EwFO"),Ie=["formDirective"],Le=["allSelected"];function Oe(e,t){if(1&e&&(L.Xb(0,"mat-option",44),L.Lc(1),L.Wb()),2&e){var i=t.$implicit;L.pc("value",i.id),L.Db(1),L.Nc(" ",i.short_name," ")}}function Re(e,t){if(1&e&&(L.Xb(0,"mat-option",44),L.Lc(1),L.Wb()),2&e){var i=t.$implicit;L.pc("value",i.id),L.Db(1),L.Nc(" ",i.short_name," ")}}function Te(e,t){if(1&e&&(L.Xb(0,"mat-option",44),L.Lc(1),L.Wb()),2&e){var i=t.$implicit;L.pc("value",i.id),L.Db(1),L.Nc(" ",i.short_name," ")}}function Ne(e,t){if(1&e&&(L.Xb(0,"mat-option",45),L.Lc(1),L.Wb()),2&e){var i=t.$implicit;L.pc("value",i.id)("matTooltip",i.full_name),L.Db(1),L.Nc(" ",i.short_name," ")}}function je(e,t){1&e&&(L.Xb(0,"mat-error"),L.Lc(1,"Agent is required!"),L.Wb())}function Fe(e,t){if(1&e&&(L.Xb(0,"mat-option",44),L.Lc(1),L.Wb()),2&e){var i=t.$implicit;L.pc("value",i.id),L.Db(1),L.Nc(" ",i.name," ")}}function Be(e,t){if(1&e){var i=L.Yb();L.Xb(0,"mat-option",31),L.fc("click",(function(e){L.Bc(i),L.jc();var t=L.xc(68);return L.jc().tosslePerOne(t.viewValue)})),L.Lc(1),L.Wb()}if(2&e){var n=t.$implicit;L.pc("value",n.id),L.Db(1),L.Mc(n.code)}}function Ve(e,t){if(1&e&&(L.Xb(0,"mat-option",44),L.Lc(1),L.Wb()),2&e){var i=t.$implicit;L.pc("value",i.id),L.Db(1),L.Nc(" ",i.code," ")}}function He(e,t){if(1&e&&(L.Xb(0,"mat-option",44),L.Lc(1),L.Wb()),2&e){var i=t.$implicit;L.pc("value",i.id),L.Db(1),L.Nc(" ",i.name," ")}}function Me(e,t){if(1&e&&(L.Xb(0,"mat-option",44),L.Lc(1),L.Wb()),2&e){var i=t.$implicit;L.pc("value",i),L.Db(1),L.Mc(i)}}var ze=function(){return[null,1,2,3,4,5,6,7,8,9,10,11,12]};function Ee(e,t){if(1&e){var i=L.Yb();L.Xb(0,"form",2,3),L.fc("keydown.enter",(function(e){return L.Bc(i),"TEXTAREA"==e.target.tagName}))("ngSubmit",(function(e){L.Bc(i);var t=L.jc();return t.onSearchFormSubmit(t.form)})),L.Xb(2,"div",4),L.Xb(3,"div",5),L.Xb(4,"button",6),L.Lc(5," Submit "),L.Wb(),L.Xb(6,"button",7),L.fc("click",(function(e){return L.Bc(i),L.jc().clearForm()})),L.Xb(7,"mat-icon"),L.Lc(8,"delete"),L.Wb(),L.Wb(),L.Xb(9,"button",8),L.fc("click",(function(e){return L.Bc(i),L.jc().typeChange.emit("edit")})),L.Xb(10,"mat-icon"),L.Lc(11,"edit"),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Xb(12,"div",9),L.Xb(13,"div",10),L.Xb(14,"div",11),L.Xb(15,"div",12),L.Xb(16,"div",13),L.Xb(17,"mat-form-field",14),L.Xb(18,"mat-label"),L.Lc(19,"Pay party"),L.Wb(),L.Sb(20,"input",15),L.Xb(21,"mat-autocomplete",16,17),L.Jc(23,Oe,2,2,"mat-option",18),L.kc(24,"async"),L.Wb(),L.Wb(),L.Wb(),L.Xb(25,"div",19),L.Xb(26,"mat-form-field",14),L.Xb(27,"mat-label"),L.Lc(28,"Issue Party"),L.Wb(),L.Sb(29,"input",20),L.Xb(30,"mat-autocomplete",16,21),L.Jc(32,Re,2,2,"mat-option",18),L.kc(33,"async"),L.Wb(),L.Wb(),L.Wb(),L.Xb(34,"div",19),L.Xb(35,"mat-form-field",14),L.Xb(36,"mat-label"),L.Lc(37,"Customer"),L.Wb(),L.Sb(38,"input",22),L.Xb(39,"mat-autocomplete",16,23),L.Jc(41,Te,2,2,"mat-option",18),L.kc(42,"async"),L.Wb(),L.Wb(),L.Wb(),L.Xb(43,"div",19),L.Xb(44,"mat-form-field",14),L.Xb(45,"mat-label"),L.Lc(46,"Agent"),L.Wb(),L.Sb(47,"input",24),L.Xb(48,"mat-autocomplete",16,25),L.Jc(50,Ne,2,3,"mat-option",26),L.kc(51,"async"),L.Wb(),L.Jc(52,je,2,0,"mat-error",27),L.Wb(),L.Wb(),L.Xb(53,"div",19),L.Xb(54,"mat-form-field",14),L.Xb(55,"mat-label"),L.Lc(56,"Voyage"),L.Wb(),L.Sb(57,"input",28),L.Xb(58,"mat-autocomplete",16,29),L.Jc(60,Fe,2,2,"mat-option",18),L.kc(61,"async"),L.Wb(),L.Wb(),L.Wb(),L.Xb(62,"div",19),L.Xb(63,"mat-form-field",14),L.Xb(64,"mat-label"),L.Lc(65,"Price"),L.Wb(),L.Xb(66,"mat-select",30),L.Xb(67,"mat-option",31,32),L.fc("click",(function(e){return L.Bc(i),L.jc().toggleAllSelection()})),L.Lc(69),L.Wb(),L.Jc(70,Be,2,2,"mat-option",33),L.Wb(),L.Wb(),L.Wb(),L.Xb(71,"div",19),L.Xb(72,"mat-form-field",14),L.Xb(73,"mat-label"),L.Lc(74,"Currency"),L.Wb(),L.Xb(75,"mat-select",34),L.Jc(76,Ve,2,2,"mat-option",18),L.Wb(),L.Wb(),L.Wb(),L.Xb(77,"div",19),L.Xb(78,"mat-form-field",14),L.Xb(79,"mat-label"),L.Lc(80,"Payment center"),L.Wb(),L.Sb(81,"input",35),L.Xb(82,"mat-autocomplete",16,36),L.Jc(84,He,2,2,"mat-option",18),L.kc(85,"async"),L.Wb(),L.Wb(),L.Wb(),L.Xb(86,"div",19),L.Xb(87,"mat-form-field",14),L.Xb(88,"mat-label"),L.Lc(89,"Date from"),L.Wb(),L.Xb(90,"input",37),L.fc("change",(function(e){return L.Bc(i),L.jc().commonService.setDateStr(e)})),L.Wb(),L.Sb(91,"mat-datepicker-toggle",38),L.Sb(92,"mat-datepicker",null,39),L.Wb(),L.Wb(),L.Xb(94,"div",19),L.Xb(95,"mat-form-field",14),L.Xb(96,"mat-label"),L.Lc(97,"Date to"),L.Wb(),L.Xb(98,"input",40),L.fc("change",(function(e){return L.Bc(i),L.jc().commonService.setDateStr(e)})),L.Wb(),L.Sb(99,"mat-datepicker-toggle",38),L.Sb(100,"mat-datepicker",null,41),L.Wb(),L.Wb(),L.Xb(102,"div",19),L.Xb(103,"mat-form-field",14),L.Xb(104,"mat-label"),L.Lc(105,"Month"),L.Wb(),L.Xb(106,"mat-select",42),L.fc("selectionChange",(function(e){return L.Bc(i),L.jc().getMonthTime("M")})),L.Jc(107,Me,2,2,"mat-option",18),L.Wb(),L.Wb(),L.Wb(),L.Xb(108,"div",19),L.Xb(109,"mat-form-field",14),L.Xb(110,"mat-label"),L.Lc(111,"Year"),L.Wb(),L.Xb(112,"mat-select",43),L.fc("selectionChange",(function(e){return L.Bc(i),L.jc().getMonthTime("Y")})),L.Xb(113,"mat-option",44),L.Lc(114),L.Wb(),L.Xb(115,"mat-option",44),L.Lc(116),L.Wb(),L.Xb(117,"mat-option",44),L.Lc(118),L.Wb(),L.Xb(119,"mat-option",44),L.Lc(120),L.Wb(),L.Xb(121,"mat-option",44),L.Lc(122),L.Wb(),L.Xb(123,"mat-option",44),L.Lc(124),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb()}if(2&e){var n=L.xc(22),r=L.xc(31),a=L.xc(40),o=L.xc(49),c=L.xc(59),s=L.xc(83),l=L.xc(93),u=L.xc(101),b=L.jc();L.pc("formGroup",b.form),L.Db(12),L.Ic("height",b.height,"px"),L.Db(8),L.pc("matAutocomplete",n),L.Db(1),L.pc("displayWith",b.commonService.displayFn.bind(b,"short_name",b.customer)),L.Db(2),L.pc("ngForOf",L.lc(24,43,b.filteredCustomer)),L.Db(6),L.pc("matAutocomplete",r),L.Db(1),L.pc("displayWith",b.commonService.displayFn.bind(b,"short_name",b.supplier)),L.Db(2),L.pc("ngForOf",L.lc(33,45,b.filteredSupplier)),L.Db(6),L.pc("matAutocomplete",a),L.Db(1),L.pc("displayWith",b.commonService.displayFn.bind(b,"short_name",b.customer)),L.Db(2),L.pc("ngForOf",L.lc(42,47,b.filteredCustomer2)),L.Db(6),L.pc("matAutocomplete",o),L.Db(1),L.pc("displayWith",b.commonService.displayFn.bind(b,"short_name",b.agent)),L.Db(2),L.pc("ngForOf",L.lc(51,49,b.filteredAgent)),L.Db(2),L.pc("ngIf",b.form.get("agent").hasError("required")),L.Db(5),L.pc("matAutocomplete",c),L.Db(1),L.pc("displayWith",b.commonService.displayFn.bind(b,"name",b.voyage)),L.Db(2),L.pc("ngForOf",L.lc(61,51,b.filteredVoyage)),L.Db(7),L.pc("value",0),L.Db(2),L.Nc("All of ",b.price.length," price"),L.Db(1),L.pc("ngForOf",b.price),L.Db(6),L.pc("ngForOf",b.currency),L.Db(5),L.pc("matAutocomplete",s),L.Db(1),L.pc("displayWith",b.commonService.displayFn.bind(b,"name",b.country)),L.Db(2),L.pc("ngForOf",L.lc(85,53,b.filteredCountry)),L.Db(6),L.pc("matDatepicker",l),L.Db(1),L.pc("for",l),L.Db(7),L.pc("matDatepicker",u),L.Db(1),L.pc("for",u),L.Db(8),L.pc("ngForOf",L.qc(55,ze)),L.Db(6),L.pc("value",b.year-4),L.Db(1),L.Mc(b.year-4),L.Db(1),L.pc("value",b.year-3),L.Db(1),L.Mc(b.year-3),L.Db(1),L.pc("value",b.year-2),L.Db(1),L.Mc(b.year-2),L.Db(1),L.pc("value",b.year-1),L.Db(1),L.Mc(b.year-1),L.Db(1),L.pc("value",b.year),L.Db(1),L.Mc(b.year),L.Db(1),L.pc("value",b.year+1),L.Db(1),L.Mc(b.year+1)}}var Ge=function(e){return{"mt-8":e}},qe=function(e){return{"red-600-fg":e}};function Je(e,t){if(1&e&&(L.Xb(0,"div",64),L.Xb(1,"div",54),L.Lc(2),L.kc(3,"number"),L.Wb(),L.Wb()),2&e){var i=t.$implicit,n=t.index,r=L.jc(2);L.pc("ngClass",L.rc(7,Ge,0==n)),L.Db(1),L.pc("ngClass",L.rc(9,qe,r.total.revenue[i]-r.total.cost[i]<0)),L.Db(1),L.Oc(" ",L.mc(3,4,r.total.revenue[i]-r.total.cost[i],"VND"!=i?"1.2-2":"1.0-0")," ",i," ")}}function Ue(e,t){1&e&&L.Sb(0,"div",65)}function Ke(e,t){if(1&e){var i=L.Yb();L.Xb(0,"form",46),L.fc("keydown.enter",(function(e){return L.Bc(i),"TEXTAREA"==e.target.tagName})),L.Xb(1,"div",4),L.Xb(2,"div",5),L.Xb(3,"button",47),L.fc("click",(function(e){L.Bc(i);var t=L.jc();return t.updateSelectItem.emit(t.formEdit.value)})),L.Lc(4," Save "),L.Wb(),L.Xb(5,"button",48),L.fc("click",(function(e){return L.Bc(i),L.jc().typeChange.emit("form")})),L.Lc(6," Search "),L.Wb(),L.Wb(),L.Wb(),L.Xb(7,"div",9),L.Xb(8,"div",10),L.Xb(9,"div",49),L.Xb(10,"div",12),L.Xb(11,"div",50),L.Xb(12,"h2"),L.Lc(13,"Total"),L.Wb(),L.Jc(14,Je,4,11,"div",51),L.Jc(15,Ue,1,0,"div",52),L.Xb(16,"div",53),L.Xb(17,"div",54),L.Lc(18),L.kc(19,"number"),L.Wb(),L.Wb(),L.Wb(),L.Xb(20,"div",19),L.Xb(21,"mat-form-field",55),L.Xb(22,"mat-label"),L.Lc(23,"Debit"),L.Wb(),L.Sb(24,"input",56),L.Xb(25,"mat-checkbox",57),L.fc("change",(function(e){return L.Bc(i),L.jc().setDisabled("debit")})),L.Wb(),L.Wb(),L.Wb(),L.Xb(26,"div",19),L.Xb(27,"mat-form-field",55),L.Xb(28,"mat-label"),L.Lc(29,"Issue date"),L.Wb(),L.Xb(30,"input",58),L.fc("change",(function(e){return L.Bc(i),L.jc().commonService.setDateStr(e)})),L.Wb(),L.Sb(31,"mat-datepicker-toggle",38),L.Sb(32,"mat-datepicker",null,59),L.Xb(34,"mat-checkbox",57),L.fc("change",(function(e){return L.Bc(i),L.jc().setDisabled("issue_date")})),L.Wb(),L.Wb(),L.Wb(),L.Xb(35,"div",19),L.Xb(36,"mat-form-field",55),L.Xb(37,"mat-label"),L.Lc(38,"Pay date"),L.Wb(),L.Xb(39,"input",60),L.fc("change",(function(e){return L.Bc(i),L.jc().commonService.setDateStr(e)})),L.Wb(),L.Sb(40,"mat-datepicker-toggle",38),L.Sb(41,"mat-datepicker",null,61),L.Xb(43,"mat-checkbox",57),L.fc("change",(function(e){return L.Bc(i),L.jc().setDisabled("pay_date")})),L.Wb(),L.Wb(),L.Wb(),L.Xb(44,"div",19),L.Xb(45,"mat-form-field",55),L.Xb(46,"mat-label"),L.Lc(47,"Exrate"),L.Wb(),L.Sb(48,"input",62),L.Xb(49,"mat-checkbox",57),L.fc("change",(function(e){return L.Bc(i),L.jc().setDisabled("ex_rate")})),L.Wb(),L.Wb(),L.Wb(),L.Xb(50,"div",19),L.Xb(51,"mat-form-field",55),L.Xb(52,"mat-label"),L.Lc(53,"Info"),L.Wb(),L.Sb(54,"input",63),L.Xb(55,"mat-checkbox",57),L.fc("change",(function(e){return L.Bc(i),L.jc().setDisabled("info")})),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb()}if(2&e){var n=L.xc(33),r=L.xc(42),a=L.jc();L.pc("formGroup",a.formEdit),L.Db(3),L.pc("disabled",0==a.selected.length),L.Db(4),L.Ic("height",a.height,"px"),L.Db(7),L.pc("ngForOf",a.total.currency),L.Db(1),L.pc("ngIf",a.total.currency.length>0),L.Db(1),L.pc("ngClass",L.rc(21,Ge,0==a.total.currency.length)),L.Db(1),L.pc("ngClass",L.rc(23,qe,a.total.VND<0)),L.Db(1),L.Nc(" ",L.mc(19,18,a.total.VND,"1.0-0")," Ex VND "),L.Db(7),L.pc("checked",a.check.debit),L.Db(5),L.pc("matDatepicker",n),L.Db(1),L.pc("for",n),L.Db(3),L.pc("checked",a.check.issue_date),L.Db(5),L.pc("matDatepicker",r),L.Db(1),L.pc("for",r),L.Db(3),L.pc("checked",a.check.pay_date),L.Db(6),L.pc("checked",a.check.ex_rate),L.Db(6),L.pc("checked",a.check.info)}}var Ye,$e=((Ye=function(){function e(t,i,n,r,a,o){_classCallCheck(this,e),this.formBuilder=t,this.authService=i,this.commonService=n,this.router=r,this.datePipe=a,this.route=o,this.fitlerShipment=new L.o,this.typeChange=new L.o,this.updateSelectItem=new L.o,this.year=(new Date).getFullYear(),this.form=this.formBuilder.group({pay_party:[null],issue_party:[null],customer:[null],agent:[null,te.y.required],voyage:[null],price:[null],currency:[null],payment_center:[null],date_from:[null],date_to:[null],month:[null],year:[null]}),this.formEdit=this.formBuilder.group({debit:[{value:null,disabled:!0}],issue_date:[{value:null,disabled:!0}],pay_date:[{value:null,disabled:!0}],ex_rate:[{value:null,disabled:!0}],info:[{value:null,disabled:!0}]}),this.check={debit:!1,issue_date:!1,pay_date:!1,ex_rate:!1,info:!1},this.now=new Date,this.height=560,this._unsubscribeAll=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.formSearch.date_from&&(this.formSearch.date_from=new Date(this.formSearch.date_from)),this.formSearch.date_to&&(this.formSearch.date_to=new Date(this.formSearch.date_to)),this.form.patchValue(this.formSearch),this.authService.windowSizeChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.height=t.height-64-64-12})),this.authService.changeScreen.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.height=t?e.authService.screenHeight-64-12:e.authService.screenHeight-64-64-12})),this.filteredCustomer=this.form.controls.pay_party.valueChanges.pipe(Object(We.a)(""),Object(Pe.a)((function(e){return e?"string"==typeof e?e:e.partner_name:null})),Object(Pe.a)((function(t){return t?e.commonService.filterData(t,"partner_name",e.customer):[]}))),this.filteredSupplier=this.form.controls.issue_party.valueChanges.pipe(Object(We.a)(""),Object(Pe.a)((function(e){return e?"string"==typeof e?e:e.partner_name:null})),Object(Pe.a)((function(t){return t?e.commonService.filterData(t,"partner_name",e.supplier):[]}))),this.filteredCustomer2=this.form.controls.customer.valueChanges.pipe(Object(We.a)(""),Object(Pe.a)((function(e){return e?"string"==typeof e?e:e.partner_name:null})),Object(Pe.a)((function(t){return t?e.commonService.filterData(t,"partner_name",e.customer):[]}))),this.filteredAgent=this.form.controls.agent.valueChanges.pipe(Object(We.a)(""),Object(Pe.a)((function(e){return e?"string"==typeof e?e:e.short_name:null})),Object(Pe.a)((function(t){return t?e.commonService.filterData(t,"short_name",e.agent):[]}))),this.filteredVoyage=this.form.controls.voyage.valueChanges.pipe(Object(We.a)(""),Object(Pe.a)((function(e){return e?"string"==typeof e?e:e.name:null})),Object(Pe.a)((function(t){return t?e.commonService.filterData(t,"name",e.voyage):[]}))),this.filteredPrice=this.form.controls.price.valueChanges.pipe(Object(We.a)(""),Object(Pe.a)((function(e){return e?"string"==typeof e?e:e.code:null})),Object(Pe.a)((function(t){return t?e.commonService.filterData(t,"code",e.price):[]}))),this.filteredCountry=this.form.controls.payment_center.valueChanges.pipe(Object(We.a)(""),Object(Pe.a)((function(e){return e?"string"==typeof e?e:e.name:null})),Object(Pe.a)((function(t){return t?e.commonService.filterData(t,"name",e.country):[]}))),this.form.valueChanges.subscribe((function(e){console.log(e)}))}},{key:"ngOnDestroy",value:function(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}},{key:"toggleAllSelection",value:function(){this.form.controls.price.patchValue(this.allSelected.selected?[].concat(_toConsumableArray(this.price.map((function(e){return e.id}))),[0]):[])}},{key:"tosslePerOne",value:function(e){if(this.allSelected.selected)return this.allSelected.deselect(),!1;this.form.controls.price.value&&this.form.controls.price.value.length==this.price.length&&this.allSelected.select()}},{key:"getMonthTime",value:function(e){var t,i,n=this.form.controls.year.value,r=this.form.controls.month.value,a=new Date,o=a.getMonth(),c=a.getFullYear();e&&"M"!=e?"Y"==e?(t=new Date(n,r?r-1:0,1),i=new Date(n,r||12,0)):"TM"==e?(this.form.controls.month.setValue(null),t=new Date(c,o,1),i=new Date(c,o+1,0)):"TY"==e&&(this.form.controls.month.setValue(null),t=new Date(c,0,1),i=new Date(c,12,0)):n&&(t=new Date(n,r?r-1:0,1),i=new Date(n,r||12,0)),this.form.controls.date_from.setValue(t),this.form.controls.date_to.setValue(i)}},{key:"clearForm",value:function(){this.searchNgForm.resetForm()}},{key:"onSearchFormSubmit",value:function(e){if(e.valid){"string"==typeof e.value.pay_party&&this.form.controls.pay_party.setValue(null),"string"==typeof e.value.issue_party&&this.form.controls.issue_party.setValue(null),"string"==typeof e.value.customer&&this.form.controls.customer.setValue(null),"string"==typeof e.value.agent&&this.form.controls.agent.setValue(null),"string"==typeof e.value.payment_center&&this.form.controls.payment_center.setValue(null),"string"==typeof e.value.price&&this.form.controls.price.setValue(null);var t=JSON.parse(JSON.stringify(e.value));t.date_from&&(t.date_from=this.datePipe.transform(new Date(t.date_from),"MM/dd/yyyy")),t.date_to&&(t.date_to=this.datePipe.transform(new Date(t.date_to),"MM/dd/yyyy")),this.fitlerShipment.emit(t)}}},{key:"setCheck",value:function(e){e.check=!e.check}},{key:"setDisabled",value:function(e){this.check[e]?this.formEdit.controls[e].disable():this.formEdit.controls[e].enable(),this.check[e]=!this.check[e]}}]),e}()).\u0275fac=function(e){return new(e||Ye)(L.Rb(te.d),L.Rb(E.a),L.Rb(ie.a),L.Rb(n.g),L.Rb(O.f),L.Rb(n.a))},Ye.\u0275cmp=L.Lb({type:Ye,selectors:[["simba-sidebar"]],viewQuery:function(e,t){var i;1&e&&(L.Sc(Ie,!0),L.Sc(Le,!0)),2&e&&(L.wc(i=L.gc())&&(t.searchNgForm=i.first),L.wc(i=L.gc())&&(t.allSelected=i.first))},inputs:{formSearch:"formSearch",customer:"customer",supplier:"supplier",agent:"agent",voyage:"voyage",price:"price",currency:"currency",country:"country",type:"type",selected:"selected",total:"total"},outputs:{fitlerShipment:"fitlerShipment",typeChange:"typeChange",updateSelectItem:"updateSelectItem"},decls:2,vars:2,consts:[["name","form",3,"formGroup","keydown.enter","ngSubmit",4,"ngIf"],["name","form",3,"formGroup","keydown.enter",4,"ngIf"],["name","form",3,"formGroup","keydown.enter","ngSubmit"],["formDirective","ngForm"],[1,"navbar-top"],["fxLayout","row","fxLayoutAlign","space-between center"],["mat-raised-button","","type","submit","fxFlex","45",1,"ml-8","mr-8",2,"border","1px solid #039BE5","border-radius","8px","color","#696969"],["mat-icon-button","","type","button","fxFlex","20",1,"ml-8","mr-8",2,"border","1px solid #F44336","border-radius","8px","color","#696969",3,"click"],["mat-icon-button","","type","button","fxFlex","20",1,"ml-8","mr-8",2,"border","1px solid #039BE5","border-radius","8px","color","#696969",3,"click"],["fusePerfectScrollbar","",1,"navbar-scroll-container"],[1,"navbar-content"],[1,"nav","material2","pb-4"],["fxLayout","row wrap"],["fxFlex","100",1,"info-line","mt-24"],["appearance","outline",1,"w-100-p","pr-sm-8"],["inputCheck","","aria-label","pay_party","matInput","","formControlName","pay_party",3,"matAutocomplete"],[3,"displayWith"],["autoCus1","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100",1,"info-line"],["inputCheck","","aria-label","issue_party","matInput","","formControlName","issue_party",3,"matAutocomplete"],["autoSup1","matAutocomplete"],["inputCheck","","aria-label","customer","matInput","","formControlName","customer",3,"matAutocomplete"],["autoCus2","matAutocomplete"],["inputCheck","","aria-label","agent","matInput","","formControlName","agent","required","",3,"matAutocomplete"],["autoSup2","matAutocomplete"],[3,"value","matTooltip",4,"ngFor","ngForOf"],[4,"ngIf"],["inputCheck","","aria-label","voyage","matInput","","formControlName","voyage",3,"matAutocomplete"],["autoVoyage","matAutocomplete"],["formControlName","price","multiple",""],[3,"value","click"],["allSelected",""],[3,"value","click",4,"ngFor","ngForOf"],["formControlName","currency"],["inputCheck","","aria-label","price","matInput","","formControlName","payment_center",3,"matAutocomplete"],["autoCountry","matAutocomplete"],["inputCheck","","matInput","","name","date_from","formControlName","date_from",3,"matDatepicker","change"],["matSuffix","",3,"for"],["dateFrom",""],["inputCheck","","matInput","","name","date_to","formControlName","date_to",3,"matDatepicker","change"],["dateTo",""],["formControlName","month",3,"selectionChange"],["formControlName","year",3,"selectionChange"],[3,"value"],[3,"value","matTooltip"],["name","form",3,"formGroup","keydown.enter"],["mat-raised-button","","type","button","fxFlex","45",1,"ml-8","mr-8",2,"border","1px solid #039BE5","border-radius","8px","color","#696969",3,"disabled","click"],["mat-raised-button","","type","button","fxFlex","45",1,"ml-8","mr-8",2,"border","1px solid #F44336","border-radius","8px","color","#696969",3,"click"],[1,"nav","material2"],["fxFlex","100",1,"group","mt-24"],["class","item",3,"ngClass",4,"ngFor","ngForOf"],["class","item-divider",4,"ngIf"],[1,"item","mb-8",3,"ngClass"],[1,"font-size-16","text-bold",3,"ngClass"],["appearance","outline",1,"padding-item","w-100-p","pr-sm-8"],["inputCheck","","matInput","","formControlName","debit"],["matPrefix","",3,"checked","change"],["inputCheck","","matInput","","name","issue_date","formControlName","issue_date",3,"matDatepicker","change"],["issue_date",""],["inputCheck","","matInput","","name","pay_date","formControlName","pay_date",3,"matDatepicker","change"],["pay_date",""],["type","number","inputCheck","","matInput","","formControlName","ex_rate"],["inputCheck","","matInput","","formControlName","info"],[1,"item",3,"ngClass"],[1,"item-divider"]],template:function(e,t){1&e&&(L.Jc(0,Ee,125,56,"form",0),L.Jc(1,Ke,56,25,"form",1)),2&e&&(L.pc("ngIf","form"==t.type),L.Db(1),L.pc("ngIf","edit"==t.type))},directives:[O.t,te.A,te.q,te.h,K.d,K.c,c.b,K.b,u.a,Xe.a,l.c,l.f,h.b,te.b,a.c,te.p,te.g,a.a,O.s,te.w,m.a,C.n,o.b,o.d,l.h,o.a,b.a,l.b,O.q,Y.a,g.a,l.g,te.u],pipes:[O.b,O.g],styles:["simba-sidebar .navbar-top{background:#fff!important;padding:13px 0;-webkit-box-pack:center;justify-content:center;height:65px;border-bottom:1px solid #a3a3a3}simba-sidebar .navbar-scroll-container{background:#fff!important}simba-sidebar .navbar-scroll-container .navbar-content{padding-top:0}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2{overflow:hidden}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .info-line{padding-left:8px;padding-right:8px;margin-bottom:-4px}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .info-line .padding-item .mat-form-field-wrapper{padding-bottom:8px}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .info-line .mat-form-field-prefix{top:-5px;margin-right:8px}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .info-line .search-shortcut{font-size:12px;padding:4px;border:1px solid #039be5;border-radius:4px;margin-right:4px;margin-bottom:4px;cursor:pointer}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .info-line .mySelectedPanel .mat-option{font-size:12px}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .info-line .mat-radio-container{-webkit-transform:scale(.6);transform:scale(.6)}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .info-line .mat-radio-label-content{font-size:12px}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .group{margin:8px 16px 8px 8px;display:-webkit-box;display:flex;-webkit-box-flex:1;flex:1 0 auto;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;position:relative;border-radius:2px;padding:28px 16px 8px;border:1px solid rgba(0,0,0,.12)}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .group h2{position:absolute;top:-11px;left:8px;margin:0;padding:0 8px;font-size:16px;font-weight:600;background:#fafafa;color:rgba(0,0,0,.54)}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .nav-item .nav-link{border-radius:20px;margin:0 12px;padding:0 12px}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .nav-item .search-partner{height:54px;min-height:54px;padding:0 8px!important;border-bottom:1px solid #e9e9e9}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .nav-item .search-partner .search-partner-name{text-overflow:ellipsis;overflow:hidden;font-size:15px;font-weight:600;padding:4px}simba-sidebar .navbar-scroll-container .navbar-content .nav.material2 .nav-item .search-partner .search-partner-name .search-item{border:1px solid #e0e0e0;padding:8px;border-radius:20px;background:#fff}navbar .navbar-top{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-flex:1;flex:1 0 auto;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;min-height:64px;max-height:64px;height:64px;padding:12px 12px 12px 20px}@media screen and (max-width:599px){navbar .navbar-top{min-height:56px;max-height:56px;height:56px}}navbar .navbar-scroll-container{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-flex:1;flex:1 1 auto;overflow-y:auto;-webkit-overflow-scrolling:touch;background:-webkit-gradient(linear,left top,left bottom,color-stop(30%,transparent),color-stop(30%,transparent)),-webkit-gradient(linear,left top,left bottom,color-stop(0,rgba(0,0,0,.25)),color-stop(40%,transparent));background:linear-gradient(transparent 30%,transparent 0),linear-gradient(rgba(0,0,0,.25),transparent 40%);background-repeat:no-repeat;background-size:100% 40px,100% 10px;background-attachment:local,scroll}navbar .navbar-scroll-container .user{position:relative;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:start;justify-content:flex-start;width:100%;height:136px;min-height:136px;max-height:136px;padding:24px 0 64px}navbar .navbar-scroll-container .user .avatar-container{position:absolute;top:92px;border-radius:50%;padding:8px;-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%}navbar .navbar-scroll-container .user .avatar-container .avatar{width:72px;height:72px;margin:0}navbar .navbar-scroll-container .navbar-content{-webkit-box-flex:1;flex:1 1 auto;padding-top:32px}"],encapsulation:2}),Ye),Qe=["googleSheet"];function Ze(e,t){if(1&e){var i=L.Yb();L.Xb(0,"fuse-sidebar",9),L.Xb(1,"simba-sidebar",10),L.fc("fitlerShipment",(function(e){return L.Bc(i),L.jc().fitlerShipment(e)}))("typeChange",(function(e){return L.Bc(i),L.jc().typeChange(e)}))("updateSelectItem",(function(e){return L.Bc(i),L.jc().updateSelectItem(e)})),L.Wb(),L.Wb()}if(2&e){var n=L.jc();L.Db(1),L.pc("type",n.type)("selected",n.selected)("total",n.total)("formSearch",n.formSearch)("customer",n.customer)("supplier",n.supplier)("agent",n.agent)("voyage",n.voyage)("price",n.price)("currency",n.currency)("country",n.country)}}var et,tt=((et=function(){function e(t,i,n,r,a,o,c,s){_classCallCheck(this,e),this._fuseSidebarService=t,this.simbaService=i,this.router=n,this.authService=r,this.route=a,this.datePipe=o,this._matDialog=c,this.googleApiService=s,this.sidebarPanel=!1,this.height=560,this.type="form",this.objShipment={},this.selected=[],this.total={VND:0,revenue:{},cost:{},currency:[]},this.totalAll={VND:0,revenue:{},cost:{},currency:[]},this.checkAll=!1,this.importData=[["1","KAI HE ZHI CHENG V. 162S","04.11.2022","XPRESS","14,456","SEHCMSIN221029-1","","1","","0","","0","7.5","7.5","-7.5","350","","307"],["2","KOTA RATNA V. 0097S","08.11.2022","PIL","14,496","SEHCMSIN221106-1","1","","","0","","5","0","5","-5","240","","240"],["3","KOTA RATNA V. 0097S","08.11.2022","PIL","14,496","SEHCMSIN221106-2","","1","","0","","0","7.5","7.5","-7.5","350","","350"],["4","WAN HAI 351 V. S002","09.11.2022","WANHAI","14,363","HKGSIN2211021","","4","","0","","0","30","30","-30","1400","","1400"],["5","WAN HAI 351 V. S002","09.11.2022","WANHAI","14,363","HKGSIN2211022","1","","185","185","","5","0","5","180","","","0"],["6","WAN HAI 351 V. S002","09.11.2022","WANHAI","14,363","HKGSIN2211023","1","","185","185","","5","0","5","180","","","0"],["7","WAN HAI 351 V. S002","09.11.2022","WANHAI","14,363","HKGSIN2211024","1","","","0","","5","0","5","-5","240","","240"],["8","WAN HAI 351 V. S002","09.11.2022","WANHAI","14,363","HKGSIN2211025","1","","","0","","5","0","5","-5","240","","240"],["9","BRIDGE V. 0255S","10.11.2022","PIL","14,363","SIHSIN221101-01","1","","","0","","5","0","5","-5","240","","240"],["10","WAN HAI 506 V. S212","11.11.2022","WANHAI","14,363","HKGSIN22110081","","1","270","270","","0","7.5","7.5","262.5","","","0"],["11","WAN HAI 506 V. S212","11.11.2022","WANHAI","14,363","HKGSIN22110082","1","","185","185","","5","0","5","180","","","0"],["12","WAN HAI 506 V. S212","11.11.2022","WANHAI","14,363","HKGSIN22110083","","1","270","270","","0","7.5","7.5","262.5","","","0"],["13","LORRAINE V. 004S","12.11.2022","WANHAI","14,363","HKGSIN22110091","","3","","0","","0","22.5","22.5","-22.5","1050","","1050"],["14","PIRA BHUM V. 552S","13.11.2022","RCL","14,446","SEHCMSIN221110-1","1","","","0","","5","0","5","-5","240","","145"],["15","MAERSK DHAKA V. 244S","14.11.2022","MCC","14,363","SEHPHSIN221107-1","1","","","0","","5","0","5","-5","240","","240"],["16","KOTA RATNA V. 0098S","15.11.2022","PIL","14,299","SEHCMSIN221112-1","1","","","0","","5","0","5","-5","240","","240"],["17","KOTA RATNA V. 0098S","15.11.2022","PIL","14,299","SEHCMSIN221113-1","1","","","0","","5","0","5","-5","240","","240"],["18","MAERSK KWANGYANG V. 245S","20.11.2022","MCC","14,015","SEHPHSIN221113-1","","1","","0","","0","7.5","7.5","-7.5","350","","350"],["19","MAERSK KWANGYANG V. 245S","20.11.2022","MCC","14,015","SEHPHSIN221113-2","1","","","0","","5","0","5","-5","240","","240"],["20","MAERSK KWANGYANG V. 245S","20.11.2022","MCC","14,015","SEHPHSIN221113-3","1","","","0","","5","0","5","-5","240","","240"],["21","PIRA BHUM V. 553S","20.11.2022","RCL","14,301","SEHCMSIN221117-1","1","","","0","","5","0","5","-5","240","","145"],["22","KOTA RATNA V. 0099S","22.11.2022","PIL","14,015","SEHCMSIN221119-1","1","","","0","","5","0","5","-5","240","","240"],["23","GREEN HOPE V. 004S","25.11.2022","VASI SHIPPING","14,102","SEHCMSIN221121-1","","1","","0","","0","7.5","7.5","-7.5","350","","350"],["24","GSL ELIZABETH V. 031S","26.11.2022","WANHAI","14,102","HKGSIN2211211","1","","","0","","5","0","5","-5","240","","240"],["25","PIRA BHUM V. 554S","27.11.2022","RCL","14,102","SEHCMSIN221124-1","2","","","0","","10","0","10","-10","480","","290"]],this.header=[],this.dataPrice=[],this._unsubscribeAll=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.searchText=this.simbaService.searchText,this.formSearch=this.simbaService.currenSearch?this.simbaService.currenSearch.formSearch:this.simbaService.defaultSearch.formSearch,this.permission=this.authService.getAction(this.router.routerState.snapshot.url.split("/")[2]),this.authService.windowSizeChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.height=t.height-64-64-20})),this.authService.changeScreen.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.height=t?e.authService.screenHeight-64-20:e.authService.screenHeight-64-64-20})),this.simbaService.onDataChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.customer=e.simbaService.dataCustomer,e.supplier=e.simbaService.dataSupplier,e.users=e.simbaService.users})),this.simbaService.onDataItemChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.agent=e.simbaService.agent,e.commodity=e.simbaService.commodity,e.packageType=e.simbaService.packageType,e.currency=e.simbaService.currency,e.country=e.simbaService.country,e.depot=e.simbaService.depot,e.price=e.simbaService.price})),this.simbaService.onShipmentChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.shipment=t.import,e.objShipment={},e.shipment.length>0&&(e.shipment.map((function(t){e.objShipment[t.code+"-"+t.price_code+"-"+t.country_name]=t})),e.header=e.simbaService.headerImp),e.filterChange()})),this.googleApiService.onFileChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){t.length>0&&(e.importData=t)}))}},{key:"ngOnDestroy",value:function(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}},{key:"toggleSidebar",value:function(e){this._fuseSidebarService.getSidebar(e).toggleOpen()}},{key:"showHideBar",value:function(e){this.sidebarPanel=!this.sidebarPanel}},{key:"refreshPage",value:function(e){this.authService.refreshData(this.simbaService)}},{key:"searchFilter",value:function(e){this.simbaService.onSearchTextChanged.next(e)}},{key:"fitlerShipment",value:function(e){var t=this;this.formSearch=e,this.authService.onRequestChanged.next(!0),Promise.all([this.simbaService.getSelShipmentSimba(e)]).then((function(e){t.authService.onRequestChanged.next(!1)}),(function(e){t.authService.onRequestChanged.next(!1),alert("Submit fail")}))}},{key:"getShipment",value:function(){var e=this;this.authService.onRequestChanged.next(!0),this.simbaService.getSelShipmentSimba(this.formSearch).then((function(t){e.authService.onRequestChanged.next(!1)})).catch((function(t){e.authService.onRequestChanged.next(!1),console.error(t),alert("Submit fail")}))}},{key:"getReportData",value:function(){var e=this;this.authService.onRequestChanged.next(!0),this.simbaService.getSelShipmentSimba(this.formSearch).then((function(t){console.log(t),e.authService.onRequestChanged.next(!1)})).catch((function(t){e.authService.onRequestChanged.next(!1),console.error(t),alert("Submit fail")}))}},{key:"typeChange",value:function(e){this.type=e}},{key:"getCheckAll",value:function(e){var t=this;this.checkAll=!0,this.selected.length==this.filterData.length&&(this.checkAll=!1),this.selected=[],this.total={VND:0,revenue:{},cost:{},currency:[]},this.filterData.map((function(e){e.select=t.checkAll,e.select&&(t.total.currency.includes(e.currency_code)||(t.total.currency.push(e.currency_code),t.total.revenue[e.currency_code]=0,t.total.cost[e.currency_code]=0),t.selected.push(e),"Revenue"==e.type_name?(t.total.revenue[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.total.VND+=e.volume*(e.amount+e.tax_amount)*e.ex_rate):(t.total.cost[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.total.VND-=e.volume*(e.amount+e.tax_amount)*e.ex_rate))}))}},{key:"getSelectItem",value:function(e){var t=this;e.select=!e.select,this.selected=[],this.total={VND:0,revenue:{},cost:{},currency:[]},this.filterData.map((function(e){e.select&&(t.total.currency.includes(e.currency_code)||(t.total.currency.push(e.currency_code),t.total.revenue[e.currency_code]=0,t.total.cost[e.currency_code]=0),t.selected.push(e),"Revenue"==e.type_name?(t.total.revenue[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.total.VND+=e.volume*(e.amount+e.tax_amount)*e.ex_rate):(t.total.cost[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.total.VND-=e.volume*(e.amount+e.tax_amount)*e.ex_rate))})),this.checkAll=!1,this.selected.length==this.filterData.length&&(this.checkAll=!0)}},{key:"updateServer",value:function(e){var t=this,i=_slicedToArray(e,3),n=i[0],r=i[1],a=i[2];switch(this.authService.onRequestChanged.next(!0),n){case"Revenue":r.pay_party=parseInt(a[1].partner),delete r.partner,this.simbaService.updateSelRevenue(r).then((function(e){t.authService.onRequestChanged.next(!1),e.affectedRows>0?t.getShipment():(console.error(e),alert("Error update item"),t.getShipment())})).catch((function(e){t.authService.onRequestChanged.next(!1),console.error(e),alert("update item error")}));break;case"Cost":r.issue_party=parseInt(a[1].partner),delete r.partner,this.simbaService.updateSelCost(r).then((function(e){t.authService.onRequestChanged.next(!1),e.affectedRows>0?t.getShipment():(console.error(e),alert("Error update item"),t.getShipment())})).catch((function(e){t.authService.onRequestChanged.next(!1),console.error(e),alert("update item error")}))}}},{key:"filterChange",value:function(e){var t=this;this.filterContent=e||null;var i=this.shipment.slice();i.map((function(e){e.issue_date&&(e.issue_date=new Date(e.issue_date).setDate(new Date(e.issue_date).getDate())),e.pay_date&&(e.pay_date=new Date(e.pay_date).setDate(new Date(e.pay_date).getDate()))})),this.filterContent&&(this.filterContent.code&&(i=i.filter((function(e){return e.code.toLowerCase().includes(t.filterContent.code.toLowerCase())}))),this.filterContent.bill&&(i=i.filter((function(e){return e.bill&&e.bill.toLowerCase().includes(t.filterContent.bill.toLowerCase())}))),this.filterContent.party&&(i=i.filter((function(e){return e.partner_short_name.toLowerCase().includes(t.filterContent.party.toLowerCase())}))),this.filterContent.price&&(i=i.filter((function(e){return e.price_code.toLowerCase().includes(t.filterContent.price.toLowerCase())}))),this.filterContent.unit&&(i=i.filter((function(e){return e.unit_code.toLowerCase().includes(t.filterContent.unit.toLowerCase())}))),this.filterContent.debit&&(i=i.filter((function(e){return e.debit&&e.debit.toLowerCase().includes(t.filterContent.debit.toLowerCase())}))),this.filterContent.issue_date&&(i=i.filter((function(e){return e.issue_date&&e.issue_date==new Date(t.filterContent.issue_date).getTime()}))),"All"!=this.filterContent.pay_date&&(1==this.filterContent.pay_date?i=i.filter((function(e){return e.pay_date})):0==this.filterContent.pay_date&&(i=i.filter((function(e){return!e.pay_date})))),this.filterContent.inv_number&&(i=i.filter((function(e){return e.inv_number&&e.inv_number.toLowerCase().includes(t.filterContent.inv_number.toLowerCase())}))),this.filterContent.bank_ref&&(i=i.filter((function(e){return e.bank_ref&&e.bank_ref.toLowerCase().includes(t.filterContent.bank_ref.toLowerCase())}))),this.filterContent.amount&&(i=i.filter((function(e){return e.amount==t.filterContent.amount}))),this.filterContent.tax&&(i=i.filter((function(e){return e.tax==t.filterContent.tax}))),this.filterContent.tax_amount&&(i=i.filter((function(e){return e.tax_amount==t.filterContent.tax_amount}))),this.filterContent.currency&&(i=i.filter((function(e){return e.currency_code.toLowerCase().includes(t.filterContent.currency.toLowerCase())}))),this.filterContent.payment_center&&(i=i.filter((function(e){return e.country_name.toLowerCase().includes(t.filterContent.payment_center.toLowerCase())}))),this.filterContent.info&&(i=i.filter((function(e){return e.info.toLowerCase().includes(t.filterContent.info.toLowerCase())}))),"All"!=this.filterContent.type_name&&(i=i.filter((function(e){return e.type_name==t.filterContent.type_name})))),this.totalAll={VND:0,revenue:{},cost:{},currency:[]},i.map((function(e){t.totalAll.currency.includes(e.currency_code)||(t.totalAll.currency.push(e.currency_code),t.totalAll.revenue[e.currency_code]=0,t.totalAll.cost[e.currency_code]=0),"Revenue"==e.type_name?(t.totalAll.revenue[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.totalAll.VND+=e.volume*(e.amount+e.tax_amount)*e.ex_rate):(t.totalAll.cost[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.totalAll.VND-=e.volume*(e.amount+e.tax_amount)*e.ex_rate)})),this.filterData=i}},{key:"updateSelectItem",value:function(e){var t=this,i=[];this.selected.map((function(e){i.push({id:e.id,type:e.type_name})})),e.issue_date&&(e.issue_date=this.datePipe.transform(e.issue_date,"yyyy-MM-dd")),e.pay_date&&(e.pay_date=this.datePipe.transform(e.pay_date,"yyyy-MM-dd")),this.authService.onRequestChanged.next(!0),this.simbaService.updateMultiShipmentItem([e,i]).then((function(e){t.getShipment(),t.selected=[]})).catch((function(e){t.authService.onRequestChanged.next(!1),console.error(e),alert("Error load data")}))}},{key:"getPrice",value:function(e){var t=this;this.dataPrice=[];var i={},n={};function r(e,t,i,n){var r=e[6]?20:40,a={shipment:t.id,code:t.code,bill:t.bill,owner:e[3],volume:20==r?e[6]:e[7],amount:20==r?e[9]/e[6]:e[9]/e[7],tax:0,tax_amount:0,price:20==r?{id:1,unit:3}:{id:90,unit:4},price_code:20==r?"OF20":"OF40",unit_code:20==r?"20DC":"40HC",currency:4,currency_code:"USD",partner:i.id,partner_short_name:i.short_name,partner_name:i.full_name,payment_center:i.country,country_name:i.country_name,ex_rate:23500,type_name:"Revenue"};if(a.shipment){var o=a.code+"-"+a.price_code+"-"+a.country_name;a.amount_shipment=n[o]?n[o]:null}return a}function a(e,t,i,n){var r=e[6]?20:40,a={shipment:t.id,code:t.code,bill:t.bill,owner:e[3],volume:20==r?e[6]:e[7],amount:20==r?e[11]/e[6]:e[12]/e[7],tax:0,tax_amount:0,price:20==r?{id:67,unit:3}:{id:121,unit:4},price_code:20==r?"ADF20":"ADF40",unit_code:20==r?"20DC":"40HC",currency:4,currency_code:"USD",partner:i.id,partner_short_name:i.short_name,partner_name:i.full_name,payment_center:i.country,country_name:i.country_name,ex_rate:23500,type_name:"Cost"};if(a.shipment){var o=a.code+"-"+a.price_code+"-"+a.country_name;a.amount_shipment=n[o]?n[o]:null}return a}function o(e,t,i,n){var r=e[6]?20:40,a={shipment:t.id,code:t.code,bill:t.bill,owner:e[3],volume:20==r?e[6]:e[7],amount:20==r?e[15]/e[6]:e[15]/e[7],tax:0,tax_amount:0,price:20==r?{id:10,unit:3}:{id:96,unit:4},price_code:20==r?"DTHC20":"DTHC40",unit_code:20==r?"20DC":"40HC",currency:173,currency_code:"SGD",partner:i.id,partner_short_name:i.short_name,partner_name:i.full_name,payment_center:i.country,country_name:i.country_name,ex_rate:17e3,type_name:"Revenue"};if(a.shipment){var o=a.code+"-"+a.price_code+"-"+a.country_name;a.amount_shipment=n[o]?n[o]:null}return a}function c(e,t,i,n){var r=e[6]?20:40,a={shipment:t.id,code:t.code,bill:t.bill,owner:e[3],volume:20==r?e[6]:e[7],amount:20==r?e[16]/e[6]:e[16]/e[7],tax:0,tax_amount:0,price:20==r?{id:53,unit:3}:{id:113,unit:4},price_code:20==r?"DIS20":"DIS40",unit_code:20==r?"20DC":"40HC",currency:173,currency_code:"SGD",partner:i.id,partner_short_name:i.short_name,partner_name:i.full_name,payment_center:i.country,country_name:i.country_name,ex_rate:17e3,type_name:"Cost"};if(a.shipment){var o=a.code+"-"+a.price_code+"-"+a.country_name;a.amount_shipment=n[o]?n[o]:null}return a}this.filterData.map((function(e){i[e.code]||(i[e.code]={id:e.shipment,code:e.code,bill:e.bill}),e.bill&&!n[e.bill]&&(n[e.bill]={id:e.shipment,code:e.code,bill:e.bill})}));var s=this.supplier.find((function(e){return e.id==t.formSearch.agent})),l=this.customer.find((function(e){return e.short_name==s.short_name})),u=this.header.indexOf("BL"),b=this.header.indexOf("OF CL"),h=this.header.indexOf("Com 20"),p=this.header.indexOf("Com 40"),m=this.header.indexOf("CL SGD"),d=this.header.indexOf("Paid SGD"),f=[];this.importData.map((function(e){if(e[6]&&e[7]){var t=0,i=0;parseInt(e[15])==225*parseInt(e[6])+335*parseInt(e[7])&&(t=225,i=335);var n=0,r=0;parseInt(e[16])==35*parseInt(e[6])+40*parseInt(e[7])&&(n=35,r=40),parseInt(e[16])==90*parseInt(e[6])+120*parseInt(e[7])&&(n=90,r=120),f.push([e[0],e[1],e[2],e[3],e[4],e[5],e[6],"",e[8],e[9],e[10],e[11],"",e[13],e[14],parseInt(e[6])*t,parseInt(e[6])*n,e[17]]),f.push([e[0],e[1],e[2],e[3],e[4],e[5],"",e[7],e[8],e[9],e[10],"",e[12],e[13],e[14],parseInt(e[7])*i,parseInt(e[7])*r,e[17]])}else f.push(e)})),f.map((function(e){if(i[e[u]]){if(e[b]){var f=r(e,i[e[u]],l,t.objShipment);f.amount>0&&t.dataPrice.push(f)}(e[h]||e[p])&&t.dataPrice.push(a(e,i[e[u]],s,t.objShipment)),e[m]&&t.dataPrice.push(o(e,i[e[u]],l,t.objShipment)),e[d]&&t.dataPrice.push(c(e,i[e[u]],s,t.objShipment))}else if(n[e[u]]){if(e[b]){var v=r(e,n[e[u]],l,t.objShipment);v.amount>0&&t.dataPrice.push(v)}(e[h]||e[p])&&t.dataPrice.push(a(e,n[e[u]],s,t.objShipment)),e[m]&&t.dataPrice.push(o(e,n[e[u]],l,t.objShipment)),e[d]&&t.dataPrice.push(c(e,n[e[u]],s,t.objShipment))}else{var g={id:null,code:null,bill:e[u]};if(e[b]){var y=r(e,g,l,t.objShipment);y.amount>0&&t.dataPrice.push(y)}(e[h]||e[p])&&t.dataPrice.push(a(e,g,s,t.objShipment)),e[m]&&t.dataPrice.push(o(e,g,l,t.objShipment)),e[d]&&t.dataPrice.push(c(e,g,s,t.objShipment))}})),e.next()}},{key:"savePrice",value:function(e){var t=this,i={shipment:e.shipment,price:e.price,volume:e.volume,amount:e.amount,tax:e.tax,tax_amount:e.tax_amount,currency:e.currency,ex_rate:e.ex_rate,payment_center:e.payment_center,update_by:this.authService.user,create_by:this.authService.user};switch(this.authService.onRequestChanged.next(!0),e.type_name){case"Revenue":i.pay_party=e.partner,this.simbaService.createSelRevenue(i).then((function(n){t.authService.onRequestChanged.next(!1),i.id=n.insertId;var r=JSON.parse(JSON.stringify(e));r.id=i.id,e.amount_shipment=i,t.shipment.push(r),t.objShipment[r.code+"-"+r.price_code+"-"+r.country_name]=r})).catch((function(i){t.authService.onRequestChanged.next(!1),console.error(i),alert("Create "+e.type_name+" error")}));break;case"Cost":i.issue_party=e.partner,this.simbaService.createSelCost(i).then((function(n){t.authService.onRequestChanged.next(!1),i.id=n.insertId;var r=JSON.parse(JSON.stringify(e));r.id=i.id,e.amount_shipment=i,t.shipment.push(r),t.objShipment[r.code+"-"+r.price_code+"-"+r.country_name]=r})).catch((function(i){t.authService.onRequestChanged.next(!1),console.error(i),alert("Create "+e.type_name+" error")}))}}},{key:"saveAllPrice",value:function(e){var t=this;this.dataPrice.map((function(e){e.code&&!e.amount_shipment&&t.savePrice(e)}))}}]),e}()).\u0275fac=function(e){return new(e||et)(L.Rb(V.a),L.Rb(G),L.Rb(n.g),L.Rb(E.a),L.Rb(n.a),L.Rb(O.f),L.Rb(f.b),L.Rb(q.a))},et.\u0275cmp=L.Lb({type:et,selectors:[["simba-import"]],viewQuery:function(e,t){var i;1&e&&L.Sc(Qe,!0),2&e&&L.wc(i=L.gc())&&(t.googleSheet=i.first)},decls:9,vars:9,consts:[[1,"page-layout","simple","left-sidebar","inner-scroll"],["class","sidebar","name","simba-sidebar","position","left","lockedOpen","gt-md",4,"ngIf"],[1,"center","mr-0","ml-0"],[3,"searchText","sidebarName","showHideBar","refreshPage","toggleSidebar","searchFilter"],[1,"content"],["fxLayout","column",1,"pl-8","pt-8",2,"overflow","auto"],["fxLayout","row wrap"],["fxFlex","100",1,"mb-4"],[3,"height","data","dataPrice","header","getPrice","savePrice","saveAllPrice"],["name","simba-sidebar","position","left","lockedOpen","gt-md",1,"sidebar"],[3,"type","selected","total","formSearch","customer","supplier","agent","voyage","price","currency","country","fitlerShipment","typeChange","updateSelectItem"]],template:function(e,t){1&e&&(L.Xb(0,"div",0),L.Jc(1,Ze,2,11,"fuse-sidebar",1),L.Xb(2,"div",2),L.Xb(3,"simba-header",3),L.fc("showHideBar",(function(e){return t.showHideBar(e)}))("refreshPage",(function(e){return t.refreshPage(e)}))("toggleSidebar",(function(e){return t.toggleSidebar(e)}))("searchFilter",(function(e){return t.searchFilter(e)})),L.Wb(),L.Xb(4,"div",4),L.Xb(5,"div",5),L.Xb(6,"div",6),L.Xb(7,"div",7),L.Xb(8,"simba-import-data",8),L.fc("getPrice",(function(e){return t.getPrice(e)}))("savePrice",(function(e){return t.savePrice(e)}))("saveAllPrice",(function(e){return t.saveAllPrice(e)})),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb()),2&e&&(L.Db(1),L.pc("ngIf",t.sidebarPanel),L.Db(2),L.pc("searchText",t.searchText)("sidebarName","simba-sidebar"),L.Db(2),L.Ic("height",t.height+8,"px"),L.Db(3),L.pc("height",t.height)("data",t.importData)("dataPrice",t.dataPrice)("header",t.header))},directives:[J.a,O.t,ee,K.d,K.b,De,Ae.a,$e],styles:["simba-import{width:100%}"],encapsulation:2}),et);function it(e,t){if(1&e&&(L.Xb(0,"th",7),L.Xb(1,"mat-form-field",8),L.Sb(2,"input",9),L.Wb(),L.Wb()),2&e){var i=t.index,n=L.jc();L.Ic("top",n.inverseOfTranslation),L.Db(2),L.pc("formControlName",i)}}function nt(e,t){if(1&e&&(L.Vb(0),L.Xb(1,"td",7),L.Lc(2),L.Wb(),L.Ub()),2&e){var i=t.$implicit;L.Db(2),L.Mc(i)}}function rt(e,t){if(1&e&&(L.Vb(0),L.Xb(1,"tr"),L.Jc(2,nt,3,1,"ng-container",10),L.Wb(),L.Ub()),2&e){var i=t.$implicit;L.Db(2),L.pc("ngForOf",i)}}var at,ot=((at=function(){function e(t,i,n,r){_classCallCheck(this,e),this.authService=t,this.datePipe=i,this.formBuilder=n,this.commonService=r,this.form=this.formBuilder.group({header:this.formBuilder.array([])})}return _createClass(e,[{key:"ngOnInit",value:function(){this.getHeader()}},{key:"ngOnChanges",value:function(e){e.data&&(e.data.currentValue||null==e.data.currentValue)&&(this.data=e.data.currentValue)}},{key:"addHeader",value:function(){this.headerAdd.push(new te.e(""))}},{key:"removeHeader",value:function(e){this.headerAdd.removeAt(e)}},{key:"getHeader",value:function(){var e=this;this.data[0]&&this.data[0].length==this.header.length&&this.header.map((function(t){e.headerAdd.push(new te.e(t))}))}},{key:"headerAdd",get:function(){return this.form.get("header")}},{key:"inverseOfTranslation",get:function(){return this.viewPort&&this.viewPort._renderedContentOffset?"-".concat(this.viewPort._renderedContentOffset,"px"):"-0px"}}]),e}()).\u0275fac=function(e){return new(e||at)(L.Rb(E.a),L.Rb(O.f),L.Rb(te.d),L.Rb(ie.a))},at.\u0275cmp=L.Lb({type:at,selectors:[["simba-export-excel-table"]],viewQuery:function(e,t){var i;1&e&&L.Sc(ne.e,!0),2&e&&L.wc(i=L.gc())&&(t.viewPort=i.first)},inputs:{height:"height",data:"data",header:"header"},features:[L.Bb()],decls:10,vars:5,consts:[["name","form","fxLayout","column",1,"content-view",3,"formGroup","keydown.enter"],["formDirective","ngForm"],["itemSize","34",1,"h-100-p"],[1,"simple","simba-excel-table"],["formArrayName","header"],["class","",3,"top",4,"ngFor","ngForOf"],[4,"cdkVirtualFor","cdkVirtualForOf"],[1,""],[1,"my-form-field"],["matInput","","inputCheck","","type","text",2,"font-size","12px",3,"formControlName"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(L.Xb(0,"form",0,1),L.fc("keydown.enter",(function(e){return"TEXTAREA"==e.target.tagName})),L.Xb(2,"cdk-virtual-scroll-viewport",2),L.Xb(3,"table",3),L.Xb(4,"thead"),L.Xb(5,"tr"),L.Vb(6,4),L.Jc(7,it,3,3,"th",5),L.Ub(),L.Wb(),L.Wb(),L.Xb(8,"tbody"),L.Jc(9,rt,3,1,"ng-container",6),L.Wb(),L.Wb(),L.Wb(),L.Wb()),2&e&&(L.Ic("height",t.height-136,"px"),L.pc("formGroup",t.form),L.Db(7),L.pc("ngForOf",t.form.value.header),L.Db(2),L.pc("cdkVirtualForOf",t.data))},directives:[te.A,te.q,K.d,te.h,ne.e,ne.a,te.c,O.s,ne.d,l.c,h.b,te.b,te.p,te.g],styles:["simba-export-excel-table .content-view{overflow:auto}simba-export-excel-table .content-view .width-form{width:1400px}@media screen and (min-width:960px)and (max-width:1279px){simba-export-excel-table .content-view .width-form{width:100%}}simba-export-excel-table .content-view .rev-color{background-color:#b3e5fc}simba-export-excel-table .content-view .cost-color{background-color:#ffcf9c}simba-export-excel-table .content-view .simba-excel-table{font-size:12px}simba-export-excel-table .content-view .simba-excel-table .border-right{border-right:1px solid rgba(0,0,0,.12)}simba-export-excel-table .content-view .simba-excel-table td,simba-export-excel-table .content-view .simba-excel-table th{padding:8px!important;white-space:nowrap}simba-export-excel-table .content-view .simba-excel-table thead th{position:sticky;position:-webkit-sticky;top:0;background:#fff;z-index:10}simba-export-excel-table .content-view .simba-excel-table .mat-standard-chip{font-size:12px;padding:4px;border-radius:10px;min-height:24px}simba-export-excel-table .content-view .simba-excel-table .sticky-left-col1{position:sticky;position:-webkit-sticky;left:0;background-color:#fff;z-index:20}simba-export-excel-table .content-view .simba-excel-table .sticky-left-col2{position:sticky;position:-webkit-sticky;left:40px;background-color:#fff;z-index:20}simba-export-excel-table .content-view .simba-excel-table .sticky-right-col{min-width:40px;position:sticky;position:-webkit-sticky;right:0;background-color:#fff}simba-export-excel-table .content-view .simba-excel-table .my-form-field .mat-form-field-wrapper{margin-bottom:-1.25em}simba-export-excel-table .content-view .simba-excel-table .my-form-field .mat-form-field-infix{margin-top:-1.25em;width:100%!important}"],encapsulation:2}),at);function ct(e,t){if(1&e&&(L.Xb(0,"span"),L.Lc(1),L.kc(2,"number"),L.Wb()),2&e){var i=L.jc().$implicit;L.Db(1),L.Mc(L.mc(2,1,i.volume*(i.amount+i.tax_amount)*i.ex_rate,"1.0-0"))}}function st(e,t){if(1&e&&(L.Xb(0,"span"),L.Lc(1),L.kc(2,"number"),L.Wb()),2&e){var i=L.jc().$implicit;L.Db(1),L.Mc(L.mc(2,1,i.volume*(i.amount+i.tax_amount)*i.ex_rate,"1.0-0"))}}function lt(e,t){if(1&e){var i=L.Yb();L.Xb(0,"mat-icon",13),L.fc("click",(function(e){L.Bc(i);var t=L.jc().$implicit,n=L.jc();return e.stopPropagation(),n.savePrice.emit(t)})),L.Lc(1,"save"),L.Wb()}}var ut=function(e){return{"red-A100-bg":e}},bt=function(e){return{"red-A700-fg":e}},ht=function(e,t){return{"red-A700-fg":e,"rev-color":t}},pt=function(e,t){return{"red-A700-fg":e,"cost-color":t}},mt=function(e,t){return{"rev-color":e,"cost-color":t}};function dt(e,t){if(1&e&&(L.Vb(0),L.Xb(1,"tr",15),L.Xb(2,"td",16),L.Lc(3),L.Wb(),L.Xb(4,"td",17),L.Lc(5),L.Wb(),L.Xb(6,"td",18),L.Lc(7),L.Wb(),L.Xb(8,"td",18),L.Lc(9),L.Wb(),L.Xb(10,"td",19),L.Lc(11),L.Wb(),L.Xb(12,"td",20),L.Lc(13),L.Wb(),L.Xb(14,"td",21),L.Lc(15),L.Wb(),L.Xb(16,"td",21),L.Lc(17),L.Wb(),L.Xb(18,"td",22),L.Lc(19),L.kc(20,"number"),L.Wb(),L.Xb(21,"td",23),L.Lc(22),L.Wb(),L.Xb(23,"td",24),L.Lc(24),L.kc(25,"number"),L.Wb(),L.Xb(26,"td",21),L.Lc(27),L.Wb(),L.Xb(28,"td",21),L.Lc(29),L.kc(30,"number"),L.Wb(),L.Xb(31,"td",22),L.Jc(32,ct,3,4,"span",25),L.Wb(),L.Xb(33,"td",22),L.Jc(34,st,3,4,"span",25),L.Wb(),L.Xb(35,"td",26),L.Lc(36),L.Wb(),L.Xb(37,"td",27),L.Lc(38),L.Wb(),L.Xb(39,"td",28),L.Lc(40),L.Wb(),L.Xb(41,"td",29),L.Jc(42,lt,2,0,"mat-icon",30),L.Wb(),L.Wb(),L.Ub()),2&e){var i=t.$implicit,n=t.index;L.Db(1),L.pc("ngClass",L.rc(37,ut,i.amount_shipment&&i.amount!=i.amount_shipment.amount)),L.Db(2),L.Mc(n+1),L.Db(2),L.Mc(i.code),L.Db(2),L.Mc(i.bill),L.Db(2),L.Mc(i.owner),L.Db(1),L.pc("matTooltip",i.partner_name)("matTooltipPosition","right"),L.Db(1),L.Mc(i.partner_short_name),L.Db(1),L.pc("matTooltip",i.price_name)("matTooltipPosition","right"),L.Db(1),L.Mc(i.price_code),L.Db(2),L.Mc(i.unit_code),L.Db(2),L.Mc(i.volume),L.Db(1),L.pc("ngClass",L.rc(39,bt,i.amount<0)),L.Db(1),L.Mc(L.mc(20,28,i.amount,"1.2-2")),L.Db(3),L.Mc(i.tax),L.Db(2),L.Mc(L.mc(25,31,i.tax_amount,"1.2-2")),L.Db(3),L.Mc(i.currency_code),L.Db(2),L.Mc(L.mc(30,34,i.ex_rate,"1.0-0")),L.Db(2),L.pc("ngClass",L.sc(41,ht,i.amount<0,"Revenue"==i.type_name)),L.Db(1),L.pc("ngIf","Revenue"==i.type_name),L.Db(1),L.pc("ngClass",L.sc(44,pt,i.amount<0,"Cost"==i.type_name)),L.Db(1),L.pc("ngIf","Cost"==i.type_name),L.Db(2),L.Mc(i.country_name),L.Db(2),L.Mc(null==i.amount_shipment?null:i.amount_shipment.amount),L.Db(1),L.pc("ngClass",L.sc(47,mt,"Revenue"==i.type_name,"Cost"==i.type_name)),L.Db(1),L.Mc(i.type_name),L.Db(2),L.pc("ngIf",i.code&&!i.amount_shipment&&"OTHER"!=i.price_code)}}var ft,vt=((ft=function(){function e(t,i,n,r){_classCallCheck(this,e),this.authService=t,this.datePipe=i,this.formBuilder=n,this.commonService=r,this.savePrice=new L.o,this.saveAllPrice=new L.o}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"inverseOfTranslation1",get:function(){return this.viewPort&&this.viewPort._renderedContentOffset?"-".concat(this.viewPort._renderedContentOffset,"px"):"-0px"}}]),e}()).\u0275fac=function(e){return new(e||ft)(L.Rb(E.a),L.Rb(O.f),L.Rb(te.d),L.Rb(ie.a))},ft.\u0275cmp=L.Lb({type:ft,selectors:[["simba-export-price-table"]],viewQuery:function(e,t){var i;1&e&&L.Sc(ne.e,!0),2&e&&L.wc(i=L.gc())&&(t.viewPort=i.first)},inputs:{height:"height",dataPrice:"dataPrice"},outputs:{savePrice:"savePrice",saveAllPrice:"saveAllPrice"},decls:46,vars:41,consts:[["fxLayout","column",1,"content-view"],["itemSize","34",1,"h-100-p"],[1,"simple","simba-price-table"],[1,"sticky-header-1","w-40","text-left","sticky-left-col1",2,"z-index","25"],[1,"sticky-header-1","w-160","sticky-left-col2",2,"z-index","25"],[1,"sticky-header-1","w-160"],[1,"sticky-header-1","w-100"],[1,"sticky-header-1","w-140"],[1,"sticky-header-1","w-60"],[1,"sticky-header-1","w-120","text-right"],[1,"sticky-header-1","w-120","text-right","rev-color"],[1,"sticky-header-1","w-120","text-right","cost-color"],[1,"sticky-header-1","w-40","sticky-right-col"],["color","accent",1,"cursor-pointer",3,"click"],[4,"cdkVirtualFor","cdkVirtualForOf"],[3,"ngClass"],[1,"w-40","text-center","sticky-left-col1"],[1,"w-160","sticky-left-col2"],[1,"w-160"],[1,"w-100",3,"matTooltip","matTooltipPosition"],[1,"w-140",3,"matTooltip","matTooltipPosition"],[1,"w-60"],[1,"w-120","text-right",3,"ngClass"],[1,"w-60","text-center"],[1,"w-100","text-right"],[4,"ngIf"],[1,"w-140"],[1,"w-120","text-right"],[1,"w-100",3,"ngClass"],[1,"sticky-right-col"],["class","cursor-pointer","color","accent",3,"click",4,"ngIf"]],template:function(e,t){1&e&&(L.Xb(0,"div",0),L.Xb(1,"cdk-virtual-scroll-viewport",1),L.Xb(2,"table",2),L.Xb(3,"thead"),L.Xb(4,"tr"),L.Xb(5,"th",3),L.Lc(6," No "),L.Wb(),L.Xb(7,"th",4),L.Lc(8,"Code"),L.Wb(),L.Xb(9,"th",5),L.Lc(10,"Bill"),L.Wb(),L.Xb(11,"th",5),L.Lc(12,"Owner"),L.Wb(),L.Xb(13,"th",6),L.Lc(14,"Party"),L.Wb(),L.Xb(15,"th",7),L.Lc(16,"Price"),L.Wb(),L.Xb(17,"th",8),L.Lc(18,"Unit"),L.Wb(),L.Xb(19,"th",8),L.Lc(20,"Volume"),L.Wb(),L.Xb(21,"th",9),L.Lc(22,"Amount"),L.Wb(),L.Xb(23,"th",8),L.Lc(24,"Tax"),L.Wb(),L.Xb(25,"th",6),L.Lc(26,"Tax Amount"),L.Wb(),L.Xb(27,"th",8),L.Lc(28,"Currency"),L.Wb(),L.Xb(29,"th",8),L.Lc(30,"Ex rate"),L.Wb(),L.Xb(31,"th",10),L.Lc(32,"Total Revenue"),L.Wb(),L.Xb(33,"th",11),L.Lc(34,"Total Cost"),L.Wb(),L.Xb(35,"th",7),L.Lc(36,"Payment center"),L.Wb(),L.Xb(37,"th",9),L.Lc(38,"Spt Amount"),L.Wb(),L.Xb(39,"th",6),L.Lc(40,"Type"),L.Wb(),L.Xb(41,"th",12),L.Xb(42,"mat-icon",13),L.fc("click",(function(e){return e.stopPropagation(),t.saveAllPrice.emit()})),L.Lc(43,"save"),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Xb(44,"tbody"),L.Jc(45,dt,43,50,"ng-container",14),L.Wb(),L.Wb(),L.Wb(),L.Wb()),2&e&&(L.Ic("height",t.height-136,"px"),L.Db(5),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(2),L.Ic("top",t.inverseOfTranslation1),L.Db(4),L.pc("cdkVirtualForOf",t.dataPrice))},directives:[K.d,ne.e,ne.a,u.a,ne.d,O.q,Y.a,b.a,O.t],pipes:[O.g],styles:["simba-export-price-table .content-view{overflow:auto}simba-export-price-table .content-view .width-form{width:1400px}@media screen and (min-width:960px)and (max-width:1279px){simba-export-price-table .content-view .width-form{width:100%}}simba-export-price-table .content-view .rev-color{background-color:#b3e5fc}simba-export-price-table .content-view .cost-color{background-color:#ffcf9c}simba-export-price-table .content-view .simba-price-table{font-size:12px}simba-export-price-table .content-view .simba-price-table .border-right{border-right:1px solid rgba(0,0,0,.12)}simba-export-price-table .content-view .simba-price-table td,simba-export-price-table .content-view .simba-price-table th{padding:8px!important;white-space:nowrap}simba-export-price-table .content-view .simba-price-table thead th.sticky-header-1{position:sticky;position:-webkit-sticky;top:0;background:#fff;z-index:10}simba-export-price-table .content-view .simba-price-table thead th.sticky-header-2{position:sticky;position:-webkit-sticky;top:32px;background:#fff;z-index:10}simba-export-price-table .content-view .simba-price-table .mat-standard-chip{font-size:12px;padding:4px;border-radius:10px;min-height:24px}simba-export-price-table .content-view .simba-price-table .sticky-left-col1{position:sticky;position:-webkit-sticky;left:0;background-color:#fff;z-index:20}simba-export-price-table .content-view .simba-price-table .sticky-left-col2{position:sticky;position:-webkit-sticky;left:40px;background-color:#fff;z-index:20}simba-export-price-table .content-view .simba-price-table .sticky-right-col{min-width:40px;position:sticky;position:-webkit-sticky;right:0;background-color:#fff}simba-export-price-table .content-view .simba-price-table .my-form-field .mat-form-field-wrapper{margin-bottom:-1.25em}simba-export-price-table .content-view .simba-price-table .my-form-field .mat-form-field-infix{margin-top:-1.25em}"],encapsulation:2}),ft),gt=["googleSheet"];function yt(e,t){1&e&&L.Lc(0,"Get data")}function xt(e,t){if(1&e){var i=L.Yb();L.Xb(0,"button",11),L.fc("click",(function(e){return L.Bc(i),L.jc().getHeader()})),L.Lc(1," Get Header "),L.Wb()}}function St(e,t){1&e&&L.Lc(0,"Price")}var _t,kt=function(e){return{hide:e}},Ct=((_t=function(){function e(t,i,n,r,a){_classCallCheck(this,e),this.authService=t,this.datePipe=i,this.formBuilder=n,this.googleApiService=r,this.commonService=a,this.getPrice=new L.o,this.savePrice=new L.o,this.saveAllPrice=new L.o,this._unsubscribeAll=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.googleApiService.onGapiChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.auth=t,e.attachSignin()}))}},{key:"ngOnDestroy",value:function(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}},{key:"attachSignin",value:function(){var e=this;this.auth.attachClickHandler(this.googleSheet._elementRef.nativeElement,{},(function(t){e.token=e.googleApiService.token=t.getAuthResponse().access_token,e.googleApiService.createPicker()}),(function(e){alert("ERROR"),console.error(e)}))}},{key:"openPicker",value:function(){this.googleApiService.createPicker()}}]),e}()).\u0275fac=function(e){return new(e||_t)(L.Rb(E.a),L.Rb(O.f),L.Rb(te.d),L.Rb(q.a),L.Rb(ie.a))},_t.\u0275cmp=L.Lb({type:_t,selectors:[["simba-export-data"]],viewQuery:function(e,t){var i;1&e&&L.Sc(gt,!0),2&e&&L.wc(i=L.gc())&&(t.googleSheet=i.first)},inputs:{height:"height",data:"data",dataPrice:"dataPrice",header:"header"},outputs:{getPrice:"getPrice",savePrice:"savePrice",saveAllPrice:"saveAllPrice"},decls:22,vars:13,consts:[["fxLayout","column"],["fxLayout","row wrap"],["fxFlex","100",3,"linear"],["stepper",""],["matStepLabel",""],[3,"height","data","header"],["fxLayout","row"],["mat-raised-button","","type","button","color","accent","id","googleSheet",1,"mr-8",3,"ngClass"],["googleSheet",""],["mat-raised-button","","type","button","color","accent","id","googleSheet2",1,"mr-8",3,"ngClass","click"],["class","mr-8","mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",1,"mr-8",3,"click"],[3,"height","dataPrice","savePrice","saveAllPrice"],["mat-raised-button","","matStepperPrevious","","type","button","color","accent",1,"mr-8"]],template:function(e,t){if(1&e){var i=L.Yb();L.Xb(0,"div",0),L.Xb(1,"div",1),L.Xb(2,"mat-horizontal-stepper",2,3),L.Xb(4,"mat-step"),L.Jc(5,yt,1,0,"ng-template",4),L.Sb(6,"simba-export-excel-table",5),L.Xb(7,"div",6),L.Xb(8,"button",7,8),L.Lc(10," Get Data "),L.Wb(),L.Xb(11,"button",9),L.fc("click",(function(e){return t.openPicker()})),L.Lc(12," Get Data "),L.Wb(),L.Jc(13,xt,2,0,"button",10),L.Xb(14,"button",11),L.fc("click",(function(e){L.Bc(i);var n=L.xc(3);return t.getPrice.emit(n)})),L.Lc(15," Get Price "),L.Wb(),L.Wb(),L.Wb(),L.Xb(16,"mat-step"),L.Jc(17,St,1,0,"ng-template",4),L.Xb(18,"simba-export-price-table",12),L.fc("savePrice",(function(e){return t.savePrice.emit(e)}))("saveAllPrice",(function(e){return t.saveAllPrice.emit(e)})),L.Wb(),L.Xb(19,"div",6),L.Xb(20,"button",13),L.Lc(21," Previous "),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb()}2&e&&(L.Db(2),L.pc("linear",!0),L.Db(4),L.pc("height",t.height)("data",t.data)("header",t.header),L.Db(2),L.pc("ngClass",L.rc(9,kt,t.token)),L.Db(3),L.pc("ngClass",L.rc(11,kt,!t.token)),L.Db(2),L.pc("ngIf",t.data.length>0),L.Db(5),L.pc("height",t.height)("dataPrice",t.dataPrice))},directives:[K.d,x.a,K.b,x.b,x.c,ot,c.b,O.q,Y.a,O.t,vt,x.f],styles:[""],encapsulation:2}),_t),wt=["googleSheet"];function Dt(e,t){if(1&e){var i=L.Yb();L.Xb(0,"fuse-sidebar",9),L.Xb(1,"simba-sidebar",10),L.fc("fitlerShipment",(function(e){return L.Bc(i),L.jc().fitlerShipment(e)}))("typeChange",(function(e){return L.Bc(i),L.jc().typeChange(e)}))("updateSelectItem",(function(e){return L.Bc(i),L.jc().updateSelectItem(e)})),L.Wb(),L.Wb()}if(2&e){var n=L.jc();L.Db(1),L.pc("type",n.type)("selected",n.selected)("total",n.total)("formSearch",n.formSearch)("customer",n.customer)("supplier",n.supplier)("agent",n.agent)("voyage",n.voyage)("price",n.price)("currency",n.currency)("country",n.country)}}var At,Wt=((At=function(){function e(t,i,n,r,a,o,c,s){_classCallCheck(this,e),this._fuseSidebarService=t,this.simbaService=i,this.router=n,this.authService=r,this.route=a,this.datePipe=o,this._matDialog=c,this.googleApiService=s,this.sidebarPanel=!1,this.height=560,this.type="form",this.priceObj={},this.objShipment={},this.selected=[],this.total={VND:0,revenue:{},cost:{},currency:[]},this.totalAll={VND:0,revenue:{},cost:{},currency:[]},this.checkAll=!1,this.importData=[["1","KOTA JAYA V. 0229N","05.11.2022","PIL","14,121","SELSINHP2211051","1","","350","","","48","76","300","774","560","56.25","17.5","0","17.5","140.25","","","0"],["2","PIRA BHUM V. 552N","07.11.2022","RCL","14,342","SELSINSG2211071","","1","430","","","60","40","835","1365","570","181","0","21.5","21.5","592.5","","125","-125"],["3","KOTA RATNA V. 0098N","09.11.2022","PIL","14,134","SELSINPG2211091","1","","400","","","100","","","500","360","15.5","20","0","20","104.5","","","0"],["4","KOTA RATNA V. 0098N","09.11.2022","PIL","14,134","SELSINSG2211091","1","","300","","","100","","","400","360","15.5","15","0","15","9.5","","","0"],["5","PIRA BHUM V. 553N","13.11.2022","RCL","14,446","SELSINSG2211131","","1","430","","","60","40","835","1365","570","181","0","21.5","21.5","592.5","","125","-125"],["6","KOTA RATNA V. 0099N","16.11.2022","PIL","14,017","SELSINSG2211161","1","","300","","","100","","","400","","","15","0","15","385","","","0"],["7","KOTA JAYA V. 0230N","20.11.2022","BGP","14,013","SELSINHP2211191","1","","450","","","100","50","","600","400","","22.5","0","22.5","177.5","","37.75","-37.75"],["8","PIRA BHUM V. 554N","21.11.2022","RCL","14,301","SELSINSG2211211","","1","430","","","60","40","835","1365","570","181","0","21.5","21.5","592.5","","125","-125"],["9","KOTA RATNA V. 0100N","23.11.2022","PIL","13,703","SELSINPG2211231","","1","800","","","200","","","1000","","","0","40","40","960","","","0"],["10","PIRA BHUM V. 555N","28.11.2022","RCL","13,998","SELSINSG2211281","1","","215","","","30","20","417.5","682.5","300","90.5","10.75","0","10.75","281.25","","95","-95"],["11","PIRA BHUM V. 555N","28.11.2022","RCL","13,998","SELSINSG2211282","","1","600","","","100","100","","800","570","31","0","30","30","169","","125","-125"],["12","PIRA BHUM V. 555N","28.11.2022","RCL","13,998","SELSINSG2211283","1","","215","","","30","20","337.5","602.5","300","15.5","10.75","0","10.75","276.25","","95","-95"],["13","KOTA NABIL V. 0218N","29.11.2022","BGP","14,102","SELSINHP2211291","","1","700","","","96","152","600","1548","800","","0","35","35","713","","43","-43"]],this.dataPrice=[],this.header=[],this._unsubscribeAll=new F.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.searchText=this.simbaService.searchText,this.formSearch=this.simbaService.currenSearch?this.simbaService.currenSearch.formSearch:this.simbaService.defaultSearch.formSearch,this.permission=this.authService.getAction(this.router.routerState.snapshot.url.split("/")[2]),this.authService.windowSizeChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.height=t.height-64-64-20})),this.authService.changeScreen.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.height=t?e.authService.screenHeight-64-20:e.authService.screenHeight-64-64-20})),this.simbaService.onDataChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.customer=e.simbaService.dataCustomer,e.supplier=e.simbaService.dataSupplier,e.users=e.simbaService.users})),this.simbaService.onDataItemChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.agent=e.simbaService.agent,e.commodity=e.simbaService.commodity,e.packageType=e.simbaService.packageType,e.currency=e.simbaService.currency,e.country=e.simbaService.country,e.depot=e.simbaService.depot,e.price=e.simbaService.price,e.priceObj={},e.price.map((function(t){e.priceObj[t.code]=t})),console.log(e.priceObj.DG20),console.log(e.priceObj.DG40)})),this.simbaService.onShipmentChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){e.shipment=t.export,e.objShipment={},e.shipment.length>0&&(e.shipment.map((function(t){e.objShipment[t.code+"-"+t.price_code+"-"+t.country_name+"-"+t.type_name]=t})),e.header=e.simbaService.headerExp),e.filterChange()})),this.googleApiService.onFileChanged.pipe(Object(B.a)(this._unsubscribeAll)).subscribe((function(t){t.length>0&&(e.importData=t)}))}},{key:"ngOnDestroy",value:function(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}},{key:"toggleSidebar",value:function(e){this._fuseSidebarService.getSidebar(e).toggleOpen()}},{key:"showHideBar",value:function(e){this.sidebarPanel=!this.sidebarPanel}},{key:"refreshPage",value:function(e){this.authService.refreshData(this.simbaService)}},{key:"searchFilter",value:function(e){this.simbaService.onSearchTextChanged.next(e)}},{key:"fitlerShipment",value:function(e){var t=this;this.formSearch=e,this.authService.onRequestChanged.next(!0),Promise.all([this.simbaService.getSelShipmentSimba(e)]).then((function(e){t.authService.onRequestChanged.next(!1)}),(function(e){t.authService.onRequestChanged.next(!1),alert("Submit fail")}))}},{key:"getShipment",value:function(){var e=this;this.authService.onRequestChanged.next(!0),this.simbaService.getSelShipmentSimba(this.formSearch).then((function(t){e.authService.onRequestChanged.next(!1)})).catch((function(t){e.authService.onRequestChanged.next(!1),console.error(t),alert("Submit fail")}))}},{key:"getReportData",value:function(){var e=this;this.authService.onRequestChanged.next(!0),this.simbaService.getSelShipmentSimba(this.formSearch).then((function(t){console.log(t),e.authService.onRequestChanged.next(!1)})).catch((function(t){e.authService.onRequestChanged.next(!1),console.error(t),alert("Submit fail")}))}},{key:"typeChange",value:function(e){this.type=e}},{key:"getCheckAll",value:function(e){var t=this;this.checkAll=!0,this.selected.length==this.filterData.length&&(this.checkAll=!1),this.selected=[],this.total={VND:0,revenue:{},cost:{},currency:[]},this.filterData.map((function(e){e.select=t.checkAll,e.select&&(t.total.currency.includes(e.currency_code)||(t.total.currency.push(e.currency_code),t.total.revenue[e.currency_code]=0,t.total.cost[e.currency_code]=0),t.selected.push(e),"Revenue"==e.type_name?(t.total.revenue[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.total.VND+=e.volume*(e.amount+e.tax_amount)*e.ex_rate):(t.total.cost[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.total.VND-=e.volume*(e.amount+e.tax_amount)*e.ex_rate))}))}},{key:"getSelectItem",value:function(e){var t=this;e.select=!e.select,this.selected=[],this.total={VND:0,revenue:{},cost:{},currency:[]},this.filterData.map((function(e){e.select&&(t.total.currency.includes(e.currency_code)||(t.total.currency.push(e.currency_code),t.total.revenue[e.currency_code]=0,t.total.cost[e.currency_code]=0),t.selected.push(e),"Revenue"==e.type_name?(t.total.revenue[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.total.VND+=e.volume*(e.amount+e.tax_amount)*e.ex_rate):(t.total.cost[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.total.VND-=e.volume*(e.amount+e.tax_amount)*e.ex_rate))})),this.checkAll=!1,this.selected.length==this.filterData.length&&(this.checkAll=!0)}},{key:"updateServer",value:function(e){var t=this,i=_slicedToArray(e,3),n=i[0],r=i[1],a=i[2];switch(this.authService.onRequestChanged.next(!0),n){case"Revenue":r.pay_party=parseInt(a[1].partner),delete r.partner,this.simbaService.updateSelRevenue(r).then((function(e){t.authService.onRequestChanged.next(!1),e.affectedRows>0?t.getShipment():(console.error(e),alert("Error update item"),t.getShipment())})).catch((function(e){t.authService.onRequestChanged.next(!1),console.error(e),alert("update item error")}));break;case"Cost":r.issue_party=parseInt(a[1].partner),delete r.partner,this.simbaService.updateSelCost(r).then((function(e){t.authService.onRequestChanged.next(!1),e.affectedRows>0?t.getShipment():(console.error(e),alert("Error update item"),t.getShipment())})).catch((function(e){t.authService.onRequestChanged.next(!1),console.error(e),alert("update item error")}))}}},{key:"filterChange",value:function(e){var t=this;this.filterContent=e||null;var i=this.shipment.slice();i.map((function(e){e.issue_date&&(e.issue_date=new Date(e.issue_date).setDate(new Date(e.issue_date).getDate())),e.pay_date&&(e.pay_date=new Date(e.pay_date).setDate(new Date(e.pay_date).getDate()))})),this.filterContent&&(this.filterContent.code&&(i=i.filter((function(e){return e.code.toLowerCase().includes(t.filterContent.code.toLowerCase())}))),this.filterContent.bill&&(i=i.filter((function(e){return e.bill&&e.bill.toLowerCase().includes(t.filterContent.bill.toLowerCase())}))),this.filterContent.party&&(i=i.filter((function(e){return e.partner_short_name.toLowerCase().includes(t.filterContent.party.toLowerCase())}))),this.filterContent.price&&(i=i.filter((function(e){return e.price_code.toLowerCase().includes(t.filterContent.price.toLowerCase())}))),this.filterContent.unit&&(i=i.filter((function(e){return e.unit_code.toLowerCase().includes(t.filterContent.unit.toLowerCase())}))),this.filterContent.debit&&(i=i.filter((function(e){return e.debit&&e.debit.toLowerCase().includes(t.filterContent.debit.toLowerCase())}))),this.filterContent.issue_date&&(i=i.filter((function(e){return e.issue_date&&e.issue_date==new Date(t.filterContent.issue_date).getTime()}))),"All"!=this.filterContent.pay_date&&(1==this.filterContent.pay_date?i=i.filter((function(e){return e.pay_date})):0==this.filterContent.pay_date&&(i=i.filter((function(e){return!e.pay_date})))),this.filterContent.inv_number&&(i=i.filter((function(e){return e.inv_number&&e.inv_number.toLowerCase().includes(t.filterContent.inv_number.toLowerCase())}))),this.filterContent.bank_ref&&(i=i.filter((function(e){return e.bank_ref&&e.bank_ref.toLowerCase().includes(t.filterContent.bank_ref.toLowerCase())}))),this.filterContent.amount&&(i=i.filter((function(e){return e.amount==t.filterContent.amount}))),this.filterContent.tax&&(i=i.filter((function(e){return e.tax==t.filterContent.tax}))),this.filterContent.tax_amount&&(i=i.filter((function(e){return e.tax_amount==t.filterContent.tax_amount}))),this.filterContent.currency&&(i=i.filter((function(e){return e.currency_code.toLowerCase().includes(t.filterContent.currency.toLowerCase())}))),this.filterContent.payment_center&&(i=i.filter((function(e){return e.country_name.toLowerCase().includes(t.filterContent.payment_center.toLowerCase())}))),this.filterContent.info&&(i=i.filter((function(e){return e.info.toLowerCase().includes(t.filterContent.info.toLowerCase())}))),"All"!=this.filterContent.type_name&&(i=i.filter((function(e){return e.type_name==t.filterContent.type_name})))),this.totalAll={VND:0,revenue:{},cost:{},currency:[]},i.map((function(e){t.totalAll.currency.includes(e.currency_code)||(t.totalAll.currency.push(e.currency_code),t.totalAll.revenue[e.currency_code]=0,t.totalAll.cost[e.currency_code]=0),"Revenue"==e.type_name?(t.totalAll.revenue[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.totalAll.VND+=e.volume*(e.amount+e.tax_amount)*e.ex_rate):(t.totalAll.cost[e.currency_code]+=e.volume*(e.amount+e.tax_amount),t.totalAll.VND-=e.volume*(e.amount+e.tax_amount)*e.ex_rate)})),this.filterData=i}},{key:"updateSelectItem",value:function(e){var t=this,i=[];this.selected.map((function(e){i.push({id:e.id,type:e.type_name})})),e.issue_date&&(e.issue_date=this.datePipe.transform(e.issue_date,"yyyy-MM-dd")),e.pay_date&&(e.pay_date=this.datePipe.transform(e.pay_date,"yyyy-MM-dd")),this.authService.onRequestChanged.next(!0),this.simbaService.updateMultiShipmentItem([e,i]).then((function(e){t.getShipment(),t.selected=[]})).catch((function(e){t.authService.onRequestChanged.next(!1),console.error(e),alert("Error load data")}))}},{key:"getPrice",value:function(e){var t=this;this.dataPrice=[];var i={},n={};function r(e,t,i,n,r,a,o,c,s,l){var u={shipment:o.id,code:o.code,bill:o.bill,owner:n,volume:t,amount:i/t,tax:0,tax_amount:0,price:r,price_code:r.code,unit_code:r.unit_code,currency:a.id,currency_code:a.code,partner:c.id,partner_short_name:c.short_name,partner_name:c.full_name,payment_center:c.country,country_name:c.country_name,ex_rate:a.exrate,type_name:l};if(u.shipment){var b=u.code+"-"+u.price_code+"-"+u.country_name+"-"+u.type_name;u.amount_shipment=s[b]?s[b]:null}return u}this.filterData.map((function(e){i[e.code]||(i[e.code]={id:e.shipment,code:e.code,bill:e.bill}),e.bill&&!n[e.bill]&&(n[e.bill]={id:e.shipment,code:e.code,bill:e.bill}),"SELSINPH2210061"==e.code&&console.log(n.SELSINPH2210061)})),console.log(n.SELSINPH2210061);var a=this.supplier.find((function(e){return e.id==t.formSearch.agent})),o=this.customer.find((function(e){return e.short_name==a.short_name})),c=this.header.indexOf("BL"),s=this.header.indexOf("OF PP"),l=this.header.indexOf("BAF"),u=this.header.indexOf("ECRS"),b=this.header.indexOf("LSS"),h=this.header.indexOf("DG"),p=this.header.indexOf("Paid OF"),m=this.header.indexOf("Paid BAF"),d=this.header.indexOf("Total Com"),f=this.header.indexOf("CL SGD"),v=this.header.indexOf("Paid SGD"),g=this.currency.find((function(e){return"USD"==e.code})),y=this.currency.find((function(e){return"SGD"==e.code}));this.importData.map((function(e){var x=e[6]?20:40,S=20==x?e[6]:e[7],_=e[3],k={id:null,code:null,bill:e[c]};i[e[c]]?(k.id=i[e[c]].id,k.code=i[e[c]].code):n[e[c]]&&(k.id=n[e[c]].id,k.code=n[e[c]].code);var C=!1;if(e[s]){var w=r(0,S,e[s],_,t.priceObj[20==x?"OF20":"OF40"],g,k,o,t.objShipment,"Revenue"),D=parseFloat(e[8])/parseInt(S)+parseFloat(e[11])/parseInt(S)+parseFloat(e[12])/parseInt(S);w.amount_shipment&&w.amount_shipment.amount==D&&(C=!0),D+=parseFloat(e[13])/parseInt(S),w.amount_shipment&&w.amount_shipment.amount==D&&(C=!0),C&&(w.code=null),t.dataPrice.push(w)}if(e[l]){var A=r(0,S,e[l],_,t.priceObj[20==x?"BAF20":"BAF40"],g,k,o,t.objShipment,"Revenue");C&&(A.code=null),t.dataPrice.push(A)}if(e[u]){var W=r(0,S,e[u],_,t.priceObj[20==x?"ECRS20":"ECRS40"],g,k,o,t.objShipment,"Revenue");C&&(W.code=null),t.dataPrice.push(W)}if(e[b]){var P=r(0,S,e[b],_,t.priceObj[20==x?"LSS20":"LSS40"],g,k,o,t.objShipment,"Revenue");C&&(P.code=null),t.dataPrice.push(P)}e[h]&&t.dataPrice.push(r(0,1,e[h],_,t.priceObj[20==x?"DG20":"DG40"],g,k,o,t.objShipment,"Revenue")),e[p]&&t.dataPrice.push(r(0,S,e[p],_,t.priceObj[20==x?"OF20":"OF40"],g,k,a,t.objShipment,"Cost")),e[m]&&t.dataPrice.push(r(0,S,e[m],_,t.priceObj[20==x?"BAF20":"BAF40"],g,k,a,t.objShipment,"Cost")),e[d]&&t.dataPrice.push(r(0,S,e[d],_,t.priceObj[20==x?"ADF20":"ADF40"],g,k,a,t.objShipment,"Cost")),e[f]&&t.dataPrice.push(r(0,S,e[f],_,t.priceObj[20==x?"LTHC20":"LTHC40"],y,k,o,t.objShipment,"Revenue")),e[v]&&t.dataPrice.push(r(0,S,e[v],_,t.priceObj[20==x?"DIS20":"DIS40"],y,k,a,t.objShipment,"Cost"))})),e.next()}},{key:"savePrice",value:function(e){var t=this,i={shipment:e.shipment,price:e.price,volume:e.volume,amount:e.amount,tax:e.tax,tax_amount:e.tax_amount,currency:e.currency,ex_rate:e.ex_rate,payment_center:e.payment_center,update_by:this.authService.user,create_by:this.authService.user};switch(console.log(e),this.authService.onRequestChanged.next(!0),e.type_name){case"Revenue":i.pay_party=e.partner,this.simbaService.createSelRevenue(i).then((function(n){t.authService.onRequestChanged.next(!1),i.id=n.insertId;var r=JSON.parse(JSON.stringify(e));r.id=i.id,e.amount_shipment=i,t.shipment.push(r),t.objShipment[r.code+"-"+r.price_code+"-"+r.country_name]=r})).catch((function(i){t.authService.onRequestChanged.next(!1),console.error(i),alert("Create "+e.type_name+" error")}));break;case"Cost":i.issue_party=e.partner,this.simbaService.createSelCost(i).then((function(n){t.authService.onRequestChanged.next(!1),i.id=n.insertId;var r=JSON.parse(JSON.stringify(e));r.id=i.id,e.amount_shipment=i,t.shipment.push(r),t.objShipment[r.code+"-"+r.price_code+"-"+r.country_name]=r})).catch((function(i){t.authService.onRequestChanged.next(!1),console.error(i),alert("Create "+e.type_name+" error")}))}}},{key:"saveAllPrice",value:function(e){var t=this;this.dataPrice.map((function(e){e.code&&!e.amount_shipment&&"DG"!=e.price_code&&t.savePrice(e)}))}}]),e}()).\u0275fac=function(e){return new(e||At)(L.Rb(V.a),L.Rb(G),L.Rb(n.g),L.Rb(E.a),L.Rb(n.a),L.Rb(O.f),L.Rb(f.b),L.Rb(q.a))},At.\u0275cmp=L.Lb({type:At,selectors:[["simba-export"]],viewQuery:function(e,t){var i;1&e&&L.Sc(wt,!0),2&e&&L.wc(i=L.gc())&&(t.googleSheet=i.first)},decls:9,vars:9,consts:[[1,"page-layout","simple","left-sidebar","inner-scroll"],["class","sidebar","name","simba-sidebar","position","left","lockedOpen","gt-md",4,"ngIf"],[1,"center","mr-0","ml-0"],[3,"searchText","sidebarName","showHideBar","refreshPage","toggleSidebar","searchFilter"],[1,"content"],["fxLayout","column",1,"pl-8","pt-8",2,"overflow","auto"],["fxLayout","row wrap"],["fxFlex","100",1,"mb-4"],[3,"height","data","dataPrice","header","getPrice","savePrice","saveAllPrice"],["name","simba-sidebar","position","left","lockedOpen","gt-md",1,"sidebar"],[3,"type","selected","total","formSearch","customer","supplier","agent","voyage","price","currency","country","fitlerShipment","typeChange","updateSelectItem"]],template:function(e,t){1&e&&(L.Xb(0,"div",0),L.Jc(1,Dt,2,11,"fuse-sidebar",1),L.Xb(2,"div",2),L.Xb(3,"simba-header",3),L.fc("showHideBar",(function(e){return t.showHideBar(e)}))("refreshPage",(function(e){return t.refreshPage(e)}))("toggleSidebar",(function(e){return t.toggleSidebar(e)}))("searchFilter",(function(e){return t.searchFilter(e)})),L.Wb(),L.Xb(4,"div",4),L.Xb(5,"div",5),L.Xb(6,"div",6),L.Xb(7,"div",7),L.Xb(8,"simba-export-data",8),L.fc("getPrice",(function(e){return t.getPrice(e)}))("savePrice",(function(e){return t.savePrice(e)}))("saveAllPrice",(function(e){return t.saveAllPrice(e)})),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb(),L.Wb()),2&e&&(L.Db(1),L.pc("ngIf",t.sidebarPanel),L.Db(2),L.pc("searchText",t.searchText)("sidebarName","simba-sidebar"),L.Db(2),L.Ic("height",t.height+8,"px"),L.Db(3),L.pc("height",t.height)("data",t.importData)("dataPrice",t.dataPrice)("header",t.header))},directives:[J.a,O.t,ee,K.d,K.b,Ct,Ae.a,$e],styles:["simba-export{width:100%}"],encapsulation:2}),At),Pt=i("cfqv");i.d(t,"SimbaModule",(function(){return Lt}));var Xt,It=[{path:"",component:j,resolve:{data:G,google:q.a},children:[{path:"import",component:tt},{path:"export",component:Wt}]}],Lt=((Xt=function e(){_classCallCheck(this,e)}).\u0275mod=L.Pb({type:Xt}),Xt.\u0275inj=L.Ob({factory:function(e){return new(e||Xt)},providers:[G],imports:[[n.k.forChild(It),r.b,a.b,o.c,c.c,s.b,l.e,u.b,b.b,h.c,p.c,m.b,d.c,f.e,v.b,g.b,y.b,x.d,S.e,_.b,k.b,w.b,D.k,A.c,C.t,W.a,P.a,X.a,I.f,ne.g,Pt.b]]}),Xt)},cfqv:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return b}));var n=i("8LU1"),r=i("vxfF"),a=i("fXoL"),o=i("HDdC"),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;_classCallCheck(this,e),this._totalWeight=0,this._defaultItemSize=t,this._averageItemSize=t}return _createClass(e,[{key:"getAverageItemSize",value:function(){return this._averageItemSize}},{key:"addSample",value:function(e,t){var i=this._totalWeight+e.end-e.start;if(i){var n=(t+this._averageItemSize*this._totalWeight)/i;n&&(this._averageItemSize=n,this._totalWeight=i)}}},{key:"reset",value:function(){this._averageItemSize=this._defaultItemSize,this._totalWeight=0}}]),e}(),s=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new c;_classCallCheck(this,e),this.scrolledIndexChange=new o.a((function(){throw Error("cdk-virtual-scroll: scrolledIndexChange is currently not supported for the autosize scroll strategy")})),this._viewport=null,this._removalFailures=0,this._minBufferPx=t,this._maxBufferPx=i,this._averager=n}return _createClass(e,[{key:"attach",value:function(e){this._averager.reset(),this._viewport=e,this._renderContentForCurrentOffset()}},{key:"detach",value:function(){this._viewport=null}},{key:"onContentScrolled",value:function(){this._viewport&&this._updateRenderedContentAfterScroll()}},{key:"onDataLengthChanged",value:function(){this._viewport&&(this._renderContentForCurrentOffset(),this._checkRenderedContentSize())}},{key:"onContentRendered",value:function(){this._viewport&&this._checkRenderedContentSize()}},{key:"onRenderedOffsetChanged",value:function(){this._viewport&&this._checkRenderedContentOffset()}},{key:"scrollToIndex",value:function(){throw Error("cdk-virtual-scroll: scrollToIndex is currently not supported for the autosize scroll strategy")}},{key:"updateBufferSize",value:function(e,t){if(t<e)throw"CDK virtual scroll: maxBufferPx must be greater than or equal to minBufferPx";this._minBufferPx=e,this._maxBufferPx=t}},{key:"_updateRenderedContentAfterScroll",value:function(){var e=this._viewport,t=e.measureScrollOffset(),i=t-this._lastScrollOffset,n=Math.abs(i),r=e.getRenderedRange(),a=0;if(i<0){var o=r.start*this._averager.getAverageItemSize();i-=a=Math.round((o-this._lastRenderedContentOffset)*Math.max(0,Math.min(1,n/(t+n)))),n=Math.abs(i)}var c=this._lastScrollOffset-this._lastRenderedContentOffset,s=this._lastRenderedContentOffset+this._lastRenderedContentSize-(this._lastScrollOffset+e.getViewportSize()),l=n+this._minBufferPx-(i<0?c:s);if(l>0)if(n>=e.getViewportSize())this._renderContentForCurrentOffset();else{var u,b,h=Math.max(0,Math.ceil((l-this._minBufferPx+this._maxBufferPx)/this._averager.getAverageItemSize())),p=(i<0?s:c)-this._minBufferPx+n,m=Math.floor(p/this._averager.getAverageItemSize()/(this._removalFailures+1)),d=Math.min(r.end-r.start,Math.max(0,m)),f=this._expandRange(r,i<0?h:0,i>0?h:0);if(i<0?f.end=Math.max(f.start+1,f.end-d):f.start=Math.min(f.end-1,f.start+d),i<0){var v=e.measureRangeSize({start:f.end,end:r.end});v<=p?(u=this._lastRenderedContentOffset+this._lastRenderedContentSize-v,this._removalFailures=0):(f.end=r.end,u=this._lastRenderedContentOffset+this._lastRenderedContentSize,this._removalFailures++),b="to-end"}else{var g=e.measureRangeSize({start:r.start,end:f.start});g<=p?(u=this._lastRenderedContentOffset+g,this._removalFailures=0):(f.start=r.start,u=this._lastRenderedContentOffset,this._removalFailures++),b="to-start"}e.setRenderedRange(f),e.setRenderedContentOffset(u+a,b)}else a&&e.setRenderedContentOffset(this._lastRenderedContentOffset+a);this._lastScrollOffset=t}},{key:"_checkRenderedContentSize",value:function(){var e=this._viewport;this._lastRenderedContentSize=e.measureRenderedContentSize(),this._averager.addSample(e.getRenderedRange(),this._lastRenderedContentSize),this._updateTotalContentSize(this._lastRenderedContentSize)}},{key:"_checkRenderedContentOffset",value:function(){this._lastRenderedContentOffset=this._viewport.getOffsetToRenderedContentStart()}},{key:"_renderContentForCurrentOffset",value:function(){var e=this._viewport,t=e.measureScrollOffset();this._lastScrollOffset=t,this._removalFailures=0;var i=this._averager.getAverageItemSize(),n=Math.min(e.getDataLength()-1,Math.floor(t/i)),r=Math.ceil(this._maxBufferPx/i),a=this._expandRange(this._getVisibleRangeForIndex(n),r,r);e.setRenderedRange(a),e.setRenderedContentOffset(i*a.start)}},{key:"_getVisibleRangeForIndex",value:function(e){var t=this._viewport,i={start:e,end:e+Math.ceil(t.getViewportSize()/this._averager.getAverageItemSize())},n=i.end-t.getDataLength();return n>0&&(i.start=Math.max(0,i.start-n)),i}},{key:"_expandRange",value:function(e,t,i){var n=this._viewport;return{start:Math.max(0,e.start-t),end:Math.min(n.getDataLength(),e.end+i)}}},{key:"_updateTotalContentSize",value:function(e){var t=this._viewport,i=t.getRenderedRange(),n=e+(t.getDataLength()-(i.end-i.start))*this._averager.getAverageItemSize();t.setTotalContentSize(n)}}]),e}();function l(e){return e._scrollStrategy}var u=function(){var e=function(){function e(){_classCallCheck(this,e),this._minBufferPx=100,this._maxBufferPx=200,this._scrollStrategy=new s(this.minBufferPx,this.maxBufferPx)}return _createClass(e,[{key:"ngOnChanges",value:function(){this._scrollStrategy.updateBufferSize(this.minBufferPx,this.maxBufferPx)}},{key:"minBufferPx",get:function(){return this._minBufferPx},set:function(e){this._minBufferPx=Object(n.f)(e)}},{key:"maxBufferPx",get:function(){return this._maxBufferPx},set:function(e){this._maxBufferPx=Object(n.f)(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=a.Mb({type:e,selectors:[["cdk-virtual-scroll-viewport","autosize",""]],inputs:{minBufferPx:"minBufferPx",maxBufferPx:"maxBufferPx"},features:[a.Cb([{provide:r.h,useFactory:l,deps:[Object(a.V)((function(){return e}))]}]),a.Bb()]}),e}(),b=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=a.Pb({type:e}),e.\u0275inj=a.Ob({factory:function(t){return new(t||e)}}),e}()},jD4G:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"filterArrayByString",value:function(e,t){var i=this;return""===t?e:(t=t.toLowerCase(),e.filter((function(e){return i.searchInObj(e,t)})))}},{key:"searchInObj",value:function(e,t){for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];if("string"==typeof n){if(this.searchInString(n,t))return!0}else if(Array.isArray(n)&&this.searchInArray(n,t))return!0;if("object"==typeof n&&this.searchInObj(n,t))return!0}}},{key:"searchInArray",value:function(e,t){var i=!0,n=!1,r=void 0;try{for(var a,o=e[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var c=a.value;if("string"==typeof c&&this.searchInString(c,t))return!0;if("object"==typeof c&&this.searchInObj(c,t))return!0}}catch(s){n=!0,r=s}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"searchInString",value:function(e,t){return e.toLowerCase().includes(t)}},{key:"generateGUID",value:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()}},{key:"toggleInArray",value:function(e,t){-1===t.indexOf(e)?t.push(e):t.splice(t.indexOf(e),1)}},{key:"handleize",value:function(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}}]),e}()}}]);