(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{"5Rfp":function(e,t,i){"use strict";i.r(t);var a=i("tyNb"),r=i("ofXK"),n=i("nmyD"),o=i("STbY"),s=i("/1cH"),c=i("iadO"),b=i("bTqV"),l=i("jaxi"),p=i("7EHt"),h=i("kmnG"),u=i("NFeN"),d=i("Qu3c"),m=i("qFsG"),f=i("wZkO"),g=i("d3UM"),k=i("QibW"),v=i("0IaG"),x=i("/t3+"),S=i("bSwM"),w=i("M9IT"),y=i("xHqg"),I=i("A5z7"),X=i("bv9b"),W=i("XhcP"),C=i("1jcm"),A=i("+0xr"),L=i("vxfF"),D=i("cfqv"),F=i("dNgK"),O=i("5HBU"),_=i("LPQX"),j=i("yrbL"),B=i("XNiG"),T=i("fXoL"),R=i("HX77"),N=i("qXBG"),P=i("2Vo4"),z=i("tk/3");let M=(()=>{class e{constructor(e,t,i){this._httpClient=e,this.authService=t,this.datePipe=i,this.objContainer={},this.onDataChanged=new P.a([]),this.onDataBankChanged=new P.a({}),this.onDataBank2Changed=new P.a({}),this.onDataViewChanged=new P.a([]),this.onBankImportChanged=new P.a([]),this.onFileSearchChanged=new P.a({}),this.onRequestProcessingChanged=new P.a(!1),this.onMovementChanged=new P.a([])}resolve(e){return this.authService.routerData=e,new Promise((e,t)=>{Promise.all([this.getData(),this.getBank(),this.getBank2()]).then(()=>{e()},t)})}getBankImportById(e){let t={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((i,a)=>{this._httpClient.get(this.authService.apiUrl+"/sel/fileImport/id/"+e,t).subscribe(e=>{this.fileImport=e,this.onBankImportChanged.next(e),i(e)},a)})}getData(){let e={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((t,i)=>{this._httpClient.get(this.authService.apiUrl+"/sel/bank-import/data",e).subscribe(e=>{this.account=e.account,this.customer=e.customer,this.type=e.dateType,this.bankType=e.bankType,this.onDataChanged.next(e),t(e)},i)})}getBank(){let e={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((t,i)=>{this._httpClient.get(this.authService.apiUrl+"/sel/bank-import/sel-bank",e).subscribe(e=>{this.selBank=e,console.log(this.selBank),this.onDataBankChanged.next(e),t(e)},i)})}getBank2(){let e={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((t,i)=>{this._httpClient.get(this.authService.apiUrl+"/sel/bank-import/sel-bank2",e).subscribe(e=>{this.onDataBank2Changed.next(e),t(e)},i)})}saveSelImport(e){let t={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((i,a)=>{this._httpClient.post(this.authService.apiUrl+"/sel/bank-import/save-import",e,t).subscribe(e=>{i(e)},a)})}updateSelBank(e,t){let i={headers:new z.c({"Content-Type":"application/json",Authorization:this.authService.accessToken})};return new Promise((a,r)=>{this._httpClient.put(this.authService.apiUrl+"/sel/connect/bank/"+t,e,i).subscribe(e=>{a(e)},r)})}getDateTime(e,t){if("string"==typeof e){let i,a=null,r=null;if(t.time?[a,r]=e.trim().split(" "):a=e,r){let e=r.trim().split(":");e[0]=parseInt(e[0])<10?"0"+e[0]:e[0],e[1]=parseInt(e[1])<10?"0"+e[1]:e[1],r=e[0]+":"+e[1]}let n=this.type.find(e=>e.id==t.dateType),o=t.year;switch(!0){case 1==n.id&&o:case 2==n.id&&o:i=a.match(/^\d{1,2}[./-]\d{1,2}[./-]\d{4}$/g);break;case 3==n.id&&o:case 4==n.id&&o:i=a.match(/^\d{4}[./-]\d{1,2}[./-]\d{1,2}$/g);break;case 1==n.id&&!o:case 2==n.id&&!o:i=a.match(/^\d{1,2}[./-]\d{1,2}[./-]\d{2}$/g);break;case 3==n.id&&!o:case 4==n.id&&!o:i=a.match(/^\d{2}[./-]\d{1,2}[./-]\d{1,2}$/g)}if(i){let e=a.split(/[./-]+/);o||(e[n.year]=2e3+parseInt(e[n.year])),a=new Date(e[n.year],e[n.month]-1,e[n.day])}else a=null;return[a,r]}if(e>25569&&e<365*((new Date).getFullYear()-1970+1)+25569){let t=new Date(86400*(e-25569)*1e3+6e4*(new Date).getTimezoneOffset()+500);return[t,this.datePipe.transform(t,"HH:mm")]}return[null,null]}createData(e,t,i){let a=[];return e.map((e,r)=>{if(this.checkHeader(r,t)){let r=e[t.column.out-1]?"string"==typeof e[t.column.out-1]?Number(e[t.column.out-1].replace(/\./g,"").replace(",",".")):e[t.column.out-1]:null,n=e[t.column.in-1]?"string"==typeof e[t.column.in-1]?Number(e[t.column.in-1].replace(/\./g,"").replace(",",".")):e[t.column.in-1]:null,o=i[t.account.id+"-"+e[t.column.transaction-1]+"-"+(n?n+"-in":r+"-out")],[s,c]=this.getDateTime(e[t.column.date-1],t),b="",l=[];s||l.push("date"),l.length>0&&(b=l.join(",")),a.push({bank_account_info:t.account,bank_account:t.account.id,date:s,transaction:e[t.column.transaction-1],content:e[t.column.content-1],out:r,in:n,exrate:1,status:1,error:b,duplicate:o||null,select:!1,sheet:e})}}),this.dataView=a,a}checkHeader(e,t){return!t.header||e>0}}return e.\u0275fac=function(t){return new(t||e)(T.bc(z.a),T.bc(N.a),T.bc(r.f))},e.\u0275prov=T.Nb({token:e,factory:e.\u0275fac}),e})();var H=i("B9zo"),q=i("EwFO"),V=i("3Pt+"),E=i("1G5W"),J=i("Kj3r"),G=i("/uUt"),U=i("0JVi"),$=i("vI/F"),Y=i("XiUz"),Q=i("znSr");const Z=["googleSheet"];function K(e,t){1&e&&(T.Xb(0,"span"),T.Lc(1,"Error:\xa0"),T.Wb())}function ee(e,t){if(1&e&&(T.Xb(0,"span",18),T.Lc(1,"Error\xa0"),T.Wb()),2&e){const e=T.jc();T.pc("matTooltip",e.errorMessage.value)("matTooltipPosition","left")}}function te(e,t){1&e&&(T.Xb(0,"span"),T.Lc(1,"Success\xa0"),T.Wb())}function ie(e,t){if(1&e){const e=T.Yb();T.Xb(0,"button",19),T.fc("click",(function(t){return T.Bc(e),T.jc().openPicker()})),T.Xb(1,"span"),T.Lc(2,"Get file3"),T.Wb(),T.Wb()}}function ae(e,t){if(1&e){const e=T.Yb();T.Xb(0,"button",20),T.fc("click",(function(t){T.Bc(e);const i=T.jc();return t.stopPropagation(),i.changeScreen(!0)})),T.Xb(1,"mat-icon"),T.Lc(2,"flip_to_front"),T.Wb(),T.Wb()}}function re(e,t){if(1&e){const e=T.Yb();T.Xb(0,"button",20),T.fc("click",(function(t){T.Bc(e);const i=T.jc();return t.stopPropagation(),i.changeScreen(!1)})),T.Xb(1,"mat-icon"),T.Lc(2,"flip_to_back"),T.Wb(),T.Wb()}}const ne=function(e,t){return{"red-600-fg":e,"green-600-fg":t}},oe=function(e){return{hide:e}};let se=(()=>{class e{constructor(e,t,i){this.authService=e,this._fuseConfigService=t,this.googleApiService=i,this.collapsed=!0,this.fullScreen=!1,this.toggleSidebar=new T.o,this.showHideBar=new T.o,this.refreshPage=new T.o,this.input=new T.o,this.sheetProperties=[],this._unsubscribeAll=new B.a}ngOnInit(){this.searchInput=new V.e(""),this.searchInput.valueChanges.pipe(Object(E.a)(this._unsubscribeAll),Object(J.a)(300),Object(G.a)()).subscribe(e=>{this.input.emit(e)}),this.googleApiService.onFormChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.validForm=this.googleApiService.validForm}),this.googleApiService.stepChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.step=e})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}ngAfterViewInit(){this.googleApiService.onGapiChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.auth=e,this.attachSignin()}),this.googleApiService.onFileDataChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{})}changeScreen(e){this.fullScreen=e,this.authService.changeScreen.next(e),this._fuseConfigService.config=this.fullScreen?{layout:{navbar:{hidden:!0},toolbar:{hidden:!0},footer:{hidden:!0},sidepanel:{hidden:!0}}}:{layout:{navbar:{hidden:!1},toolbar:{hidden:!1},footer:{hidden:!0},sidepanel:{hidden:!0}}}}collapse(){this.collapsed=!0}expand(){this.collapsed=!1}attachSignin(){this.auth.attachClickHandler(this.googleSheet._elementRef.nativeElement,{},e=>{this.token=this.googleApiService.token=e.getAuthResponse().access_token,this.googleApiService.createPicker()},(function(e){alert("ERROR"),console.error(e)}))}openPicker(){this.googleApiService.createPicker()}checkForm(){this.googleApiService.onValidateForm.next(!0)}}return e.\u0275fac=function(t){return new(t||e)(T.Rb(N.a),T.Rb(U.b),T.Rb($.a))},e.\u0275cmp=T.Lb({type:e,selectors:[["bank-import-header"]],viewQuery:function(e,t){var i;1&e&&T.Sc(Z,!0),2&e&&T.wc(i=T.gc())&&(t.googleSheet=i.first)},inputs:{sidebarName:"sidebarName",errorMessage:"errorMessage",spreadsheetId:"spreadsheetId"},outputs:{toggleSidebar:"toggleSidebar",showHideBar:"showHideBar",refreshPage:"refreshPage",input:"input"},decls:31,vars:21,consts:[[1,"p-0","mat-elevation-z1"],["fxFlex","","fxFill","","fxLayout","row","fxLayoutAlign","start center"],["fxFlex","1 0 auto","fxLayout","row","fxLayoutAlign","start center"],[1,"px-8","px-md-16"],["mat-icon-button","","fxHide.gt-sm","","fxFlex","10","fxFlex.gt-sm","0",1,"sidebar-toggle","mr-12",3,"click"],["mat-icon-button","","fxHide","","fxShow.gt-sm","","fxFlex","10","fxFlex.gt-sm","0",1,"sidebar-toggle","mr-12",3,"click"],["fxHide","","fxShow.gt-sm","",1,"m-8","font-size-12",3,"ngClass"],[4,"ngIf"],["fxHide.gt-sm","",1,"m-8","font-size-12",3,"ngClass"],[3,"matTooltip","matTooltipPosition",4,"ngIf"],["fxFlex","0 1 auto","fxLayout","row","fxLayoutAlign","start center",1,""],[1,"toolbar-separator"],["type","button","mat-raised-button","","color","accent","id","googleSheet",1,"m-8",3,"ngClass"],["googleSheet",""],["type","button","mat-raised-button","","color","accent","id","googleSheet2",1,"m-8",3,"ngClass","click"],["type","button","mat-raised-button","","color","accent","class","m-8","id","googleSheet3",3,"click",4,"ngIf"],["mat-icon-button","","class","ml-8",3,"click",4,"ngIf"],["fxHide","","fxShow.gt-xs","",1,"toolbar-separator"],[3,"matTooltip","matTooltipPosition"],["type","button","mat-raised-button","","color","accent","id","googleSheet3",1,"m-8",3,"click"],["mat-icon-button","",1,"ml-8",3,"click"]],template:function(e,t){1&e&&(T.Xb(0,"mat-toolbar",0),T.Xb(1,"div",1),T.Xb(2,"div",2),T.Xb(3,"div",3),T.Xb(4,"button",4),T.fc("click",(function(e){return t.toggleSidebar.emit(t.sidebarName)})),T.Xb(5,"mat-icon"),T.Lc(6,"menu"),T.Wb(),T.Wb(),T.Xb(7,"button",5),T.fc("click",(function(e){return t.showHideBar.emit()})),T.Xb(8,"mat-icon"),T.Lc(9,"menu"),T.Wb(),T.Wb(),T.Wb(),T.Xb(10,"div",6),T.Jc(11,K,2,0,"span",7),T.Xb(12,"span"),T.Lc(13),T.Wb(),T.Wb(),T.Xb(14,"div",8),T.Jc(15,ee,2,2,"span",9),T.Jc(16,te,2,0,"span",7),T.Wb(),T.Wb(),T.Xb(17,"div",10),T.Sb(18,"div",11),T.Xb(19,"button",12,13),T.Xb(21,"span"),T.Lc(22,"Get file1"),T.Wb(),T.Wb(),T.Xb(23,"button",14),T.fc("click",(function(e){return t.checkForm()})),T.Xb(24,"span"),T.Lc(25,"Get file2"),T.Wb(),T.Wb(),T.Jc(26,ie,3,0,"button",15),T.Sb(27,"div",11),T.Jc(28,ae,3,0,"button",16),T.Jc(29,re,3,0,"button",16),T.Sb(30,"div",17),T.Wb(),T.Wb(),T.Wb()),2&e&&(T.Db(10),T.pc("ngClass",T.sc(11,ne,t.errorMessage.status,!t.errorMessage.status)),T.Db(1),T.pc("ngIf",t.errorMessage.status),T.Db(2),T.Mc(t.errorMessage.value),T.Db(1),T.pc("ngClass",T.sc(14,ne,t.errorMessage.status,!t.errorMessage.status)),T.Db(1),T.pc("ngIf",t.errorMessage.status),T.Db(1),T.pc("ngIf",!t.errorMessage.status&&t.errorMessage.value),T.Db(3),T.pc("ngClass",T.rc(17,oe,t.token||!t.validForm)),T.Db(4),T.pc("ngClass",T.rc(19,oe,t.validForm||0!=t.step)),T.Db(3),T.pc("ngIf",t.validForm&&t.token&&0==t.step),T.Db(2),T.pc("ngIf",!t.fullScreen),T.Db(1),T.pc("ngIf",t.fullScreen))},directives:[x.a,Y.b,Y.e,Y.d,Y.c,b.b,Q.b,u.a,r.q,Q.a,r.t,d.a],styles:["bank-import-header{position:relative;display:-webkit-box;display:flex;-webkit-box-flex:0;flex:0 0 auto;z-index:4}bank-import-header.below{z-index:2}bank-import-header .mat-toolbar{position:relative;background:#fff!important;color:inherit!important}bank-import-header .logo{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}bank-import-header .logo .logo-icon{width:38px}bank-import-header .chat-panel-toggle-button,bank-import-header .language-button,bank-import-header .quick-panel-toggle-button,bank-import-header .user-button,bank-import-header fuse-search-bar{min-width:64px;height:64px}@media screen and (max-width:599px){bank-import-header .chat-panel-toggle-button,bank-import-header .language-button,bank-import-header .quick-panel-toggle-button,bank-import-header .user-button,bank-import-header fuse-search-bar{height:56px}}bank-import-header .navbar-toggle-button{min-width:56px;height:56px}bank-import-header .toolbar-separator{height:64px;width:1px;background:#e6e6e6}@media screen and (max-width:599px){bank-import-header .toolbar-separator{height:56px}}bank-import-header #fileImport-detail-search-bar{display:-webkit-box;display:flex;-webkit-box-flex:0;flex:0 1 auto;min-width:64px;height:64px;font-size:13px}@media screen and (max-width:599px){bank-import-header #fileImport-detail-search-bar{height:56px}}bank-import-header #fileImport-detail-search-bar .fileImport-detail-search-bar-content{display:-webkit-box;display:flex;-webkit-box-flex:1;flex:1 1 auto;-webkit-box-align:center;align-items:center;-webkit-box-pack:start;justify-content:flex-start}bank-import-header #fileImport-detail-search-bar .fileImport-detail-search-bar-content .fileImport-detail-search-bar-collapser,bank-import-header #fileImport-detail-search-bar .fileImport-detail-search-bar-content .fileImport-detail-search-bar-expander{cursor:pointer;padding:0 20px;margin:0;width:64px!important;height:64px!important;line-height:64px!important}@media screen and (max-width:599px){bank-import-header #fileImport-detail-search-bar .fileImport-detail-search-bar-content .fileImport-detail-search-bar-collapser,bank-import-header #fileImport-detail-search-bar .fileImport-detail-search-bar-content .fileImport-detail-search-bar-expander{height:56px!important;line-height:56px!important}}bank-import-header #fileImport-detail-search-bar .fileImport-detail-search-bar-content .fileImport-detail-search-bar-loader{width:64px!important;height:64px!important;line-height:64px!important}@media screen and (max-width:599px){bank-import-header #fileImport-detail-search-bar .fileImport-detail-search-bar-content .fileImport-detail-search-bar-loader{height:56px!important;line-height:56px!important}}bank-import-header #fileImport-detail-search-bar .fileImport-detail-search-bar-content .fileImport-detail-search-bar-collapser{display:none}bank-import-header #fileImport-detail-search-bar .fileImport-detail-search-bar-content #fileImport-detail-search-bar-input{display:none;-webkit-box-flex:1;flex:1 0 auto;min-height:64px;font-size:16px;background-color:transparent;color:currentColor}bank-import-header #fileImport-detail-search-bar.expanded{position:absolute;top:0;right:0;bottom:0;left:0;z-index:10;background:#f5f5f5}bank-import-header #fileImport-detail-search-bar.expanded .fileImport-detail-search-bar-content #fileImport-detail-search-bar-input{display:-webkit-box;display:flex}bank-import-header #fileImport-detail-search-bar.expanded .fileImport-detail-search-bar-content .fileImport-detail-search-bar-collapser{display:block}"],encapsulation:2}),e})();var ce=i("fE3o"),be=i("0Zc1");const le=function(e,t,i,a){return{current:e,completed:t,last:i,first:a}};function pe(e,t){if(1&e){const e=T.Yb();T.Xb(0,"div",5),T.fc("click",(function(i){T.Bc(e);const a=t.index;return T.jc().gotoStep(a)})),T.Xb(1,"div",6),T.Xb(2,"span"),T.Lc(3),T.Wb(),T.Wb(),T.Xb(4,"div",7),T.Lc(5),T.Wb(),T.Wb()}if(2&e){const e=t.$implicit,i=t.index,a=t.last,r=t.first,n=T.jc();T.pc("ngClass",T.uc(3,le,n.currentStep===i,n.currentStep>i,a,r)),T.Db(3),T.Mc(i+1),T.Db(2),T.Mc(e.title)}}let he=(()=>{class e{constructor(e,t,i,a,r){this.formBuilder=e,this.authService=t,this.router=i,this.commonService=a,this.googleApiService=r,this.getUpdate=new T.o,this.viewChanged=new T.o,this.height=560,this.steps=[{title:"Set info import",url:"/apps/sel-admin/bank-import/view"},{title:"Import to server",url:"/apps/sel-admin/bank-import/table"}],this._unsubscribeAll=new B.a}ngOnInit(){this.currentStep=0,this.authService.windowSizeChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.height=e.height-64-64-12}),this.authService.changeScreen.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.height=e?this.authService.screenHeight-64-12:this.authService.screenHeight-64-64-12}),this.googleApiService.stepChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.changeStep(e)})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}gotoStep(e){0==e&&this.googleApiService.stepChanged.next(e)}changeStep(e){this.currentStep!=e&&this.router.navigate([this.steps[e].url]),this.currentStep=e}}return e.\u0275fac=function(t){return new(t||e)(T.Rb(V.d),T.Rb(N.a),T.Rb(a.g),T.Rb(be.a),T.Rb($.a))},e.\u0275cmp=T.Lb({type:e,selectors:[["bank-import-sidebar"]],inputs:{view:"view",column:"column",supplier:"supplier",moveType:"moveType"},outputs:{getUpdate:"getUpdate",viewChanged:"viewChanged"},decls:5,vars:3,consts:[[1,"navbar-top"],["fxLayout","row","fxLayoutAlign","space-between center"],["fusePerfectScrollbar","",1,"navbar-scroll-fileImport"],[1,"steps"],["class","step",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"step",3,"ngClass","click"],[1,"index"],[1,"title"]],template:function(e,t){1&e&&(T.Xb(0,"div",0),T.Sb(1,"div",1),T.Wb(),T.Xb(2,"div",2),T.Xb(3,"div",3),T.Jc(4,pe,6,8,"div",4),T.Wb(),T.Wb()),2&e&&(T.Db(2),T.Ic("height",t.height,"px"),T.Db(2),T.pc("ngForOf",t.steps))},directives:[Y.d,Y.c,q.a,r.s,r.q,Q.a],styles:['bank-import-sidebar .navbar-top{background:#fff!important;padding:13px 0;-webkit-box-pack:center;justify-content:center;height:65px;border-bottom:1px solid #a3a3a3}bank-import-sidebar .navbar-scroll-fileImport{background:#fff!important}bank-import-sidebar .navbar-scroll-fileImport .steps{padding:16px 0}bank-import-sidebar .navbar-scroll-fileImport .steps .step{position:relative;display:-webkit-box;display:flex;-webkit-box-pack:start;justify-content:flex-start;-webkit-box-align:center;align-items:center;padding:16px;cursor:pointer}bank-import-sidebar .navbar-scroll-fileImport .steps .step.current .index span{border:2px solid}bank-import-sidebar .navbar-scroll-fileImport .steps .step.current .title{font-weight:700}bank-import-sidebar .navbar-scroll-fileImport .steps .step.completed .index span{border:2px solid}bank-import-sidebar .navbar-scroll-fileImport .steps .step.first .index:before,bank-import-sidebar .navbar-scroll-fileImport .steps .step.last .index:after{display:none}bank-import-sidebar .navbar-scroll-fileImport .steps .step .index{display:-webkit-box;display:flex;margin-right:12px}bank-import-sidebar .navbar-scroll-fileImport .steps .step .index:after,bank-import-sidebar .navbar-scroll-fileImport .steps .step .index:before{position:absolute;display:block;content:" ";border-left:1px solid;width:1px;height:50%;left:29px;z-index:8}bank-import-sidebar .navbar-scroll-fileImport .steps .step .index:before{top:0}bank-import-sidebar .navbar-scroll-fileImport .steps .step .index:after{bottom:0}bank-import-sidebar .navbar-scroll-fileImport .steps .step .index span{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;position:relative;width:28px;min-width:28px;max-width:28px;height:28px;border-radius:100%;border:2px solid;font-weight:700;font-size:12px;z-index:10}bank-import-sidebar .navbar-scroll-fileImport .steps .step .title,navbar .navbar-top{display:-webkit-box;display:flex}navbar .navbar-top{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-flex:1;flex:1 0 auto;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;min-height:64px;max-height:64px;height:64px;padding:12px 12px 12px 20px}@media screen and (max-width:599px){navbar .navbar-top{min-height:56px;max-height:56px;height:56px}}navbar .navbar-scroll-fileImport{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-flex:1;flex:1 1 auto;overflow-y:auto;-webkit-overflow-scrolling:touch;background:-webkit-gradient(linear,left top,left bottom,color-stop(30%,transparent),color-stop(30%,transparent)),-webkit-gradient(linear,left top,left bottom,color-stop(0,rgba(0,0,0,.25)),color-stop(40%,transparent));background:linear-gradient(transparent 30%,transparent 0),linear-gradient(rgba(0,0,0,.25),transparent 40%);background-repeat:no-repeat;background-size:100% 40px,100% 10px;background-attachment:local,scroll}navbar .navbar-scroll-fileImport .navbar-content{-webkit-box-flex:1;flex:1 1 auto;padding-top:32px}'],encapsulation:2}),e})();function ue(e,t){1&e&&(T.Xb(0,"fuse-sidebar",6),T.Xb(1,"div",7),T.Sb(2,"bank-import-sidebar"),T.Wb(),T.Wb())}function de(e,t){1&e&&T.Sb(0,"router-outlet")}let me=(()=>{class e{constructor(e,t,i,a,r,n){this._fuseSidebarService=e,this.authService=t,this.bankImportService=i,this.router=a,this.route=r,this.datePipe=n,this.height=560,this.sidebarPanel=!0,this.errorMessage={status:!1,value:""},this._unsubscribeAll=new B.a}ngOnInit(){this.id="test",this.authService.windowSizeChanged.pipe(Object(j.takeUntil)(this._unsubscribeAll)).subscribe(e=>{this.height=e.height-64-12-12-54-62}),this.authService.changeScreen.pipe(Object(j.takeUntil)(this._unsubscribeAll)).subscribe(e=>{this.height=e?this.authService.screenHeight-12-12-54-62:this.authService.screenHeight-64-12-12-54-62})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}toggleSidebar(e){this._fuseSidebarService.getSidebar(e).toggleOpen()}showHideBar(e){this.sidebarPanel=!this.sidebarPanel}refreshPage(e){this.authService.refreshData(this.bankImportService)}}return e.\u0275fac=function(t){return new(t||e)(T.Rb(R.a),T.Rb(N.a),T.Rb(M),T.Rb(a.g),T.Rb(a.a),T.Rb(r.f))},e.\u0275cmp=T.Lb({type:e,selectors:[["bank-import"]],decls:6,vars:5,consts:[["id","bank-import",1,"page-layout","simple","left-sidebar","inner-scroll"],["class","sidebar","name","bank-import-sidebar","position","left","lockedOpen","gt-md",4,"ngIf"],["fusePerfectScrollbar","",1,"center"],[3,"sidebarName","spreadsheetId","errorMessage","showHideBar","refreshPage","toggleSidebar"],[1,"content","p-8",2,"background","white"],[4,"ngIf"],["name","bank-import-sidebar","position","left","lockedOpen","gt-md",1,"sidebar"],[1,"content"]],template:function(e,t){1&e&&(T.Xb(0,"div",0),T.Jc(1,ue,3,0,"fuse-sidebar",1),T.Xb(2,"div",2),T.Xb(3,"bank-import-header",3),T.fc("showHideBar",(function(e){return t.showHideBar(e)}))("refreshPage",(function(e){return t.refreshPage(e)}))("toggleSidebar",(function(e){return t.toggleSidebar(e)})),T.Wb(),T.Xb(4,"div",4),T.Jc(5,de,1,0,"router-outlet",5),T.Wb(),T.Wb(),T.Wb()),2&e&&(T.Db(1),T.pc("ngIf",t.sidebarPanel),T.Db(2),T.pc("sidebarName","bank-import-sidebar")("spreadsheetId",t.id)("errorMessage",t.errorMessage),T.Db(2),T.pc("ngIf",!0))},directives:[H.a,r.t,q.a,se,ce.a,he,a.l],styles:[""]}),e})();var fe=i("PVWW");function ge(e){let t=e.value;return""!=t&&t?t&&t.match(/^[A-Z]\d{1,}[:][A-Z]\d{1,}$/g)?null:{validRange:!0}:null}var ke=i("FKr1");const ve=["formDirective"],xe=["googleSheet"];function Se(e,t){if(1&e&&(T.Xb(0,"mat-option",36),T.Lc(1),T.Wb()),2&e){const e=t.$implicit;T.pc("value",e),T.Db(1),T.Nc(" ",e.account," ")}}function we(e,t){1&e&&(T.Xb(0,"span"),T.Lc(1,"yyyy/"),T.Wb())}function ye(e,t){1&e&&(T.Xb(0,"span"),T.Lc(1,"yy/"),T.Wb())}function Ie(e,t){1&e&&(T.Xb(0,"span"),T.Lc(1,"/yyyy"),T.Wb())}function Xe(e,t){1&e&&(T.Xb(0,"span"),T.Lc(1,"/yy"),T.Wb())}function We(e,t){1&e&&(T.Xb(0,"span"),T.Lc(1,"hh:mm"),T.Wb())}function Ce(e,t){if(1&e&&(T.Xb(0,"mat-radio-button",6),T.Jc(1,we,2,0,"span",37),T.Jc(2,ye,2,0,"span",37),T.Xb(3,"span"),T.Lc(4),T.Wb(),T.Jc(5,Ie,2,0,"span",37),T.Jc(6,Xe,2,0,"span",37),T.Lc(7," \xa0 "),T.Jc(8,We,2,0,"span",37),T.Wb()),2&e){const e=t.$implicit,i=T.jc();T.pc("value",e.id)("checked",i.form.value.dateType==e.id),T.Db(1),T.pc("ngIf",i.form.value.year&&!e.yearFirst),T.Db(1),T.pc("ngIf",!i.form.value.year&&!e.yearFirst),T.Db(2),T.Mc(e.code),T.Db(1),T.pc("ngIf",i.form.value.year&&e.yearFirst),T.Db(1),T.pc("ngIf",!i.form.value.year&&e.yearFirst),T.Db(2),T.pc("ngIf",i.form.value.time)}}const Ae=function(){return{value:"50"}};let Le=(()=>{class e{constructor(e,t,i,a,r,n,o,s,c){this.router=e,this.route=t,this.authService=i,this.bankImportService=a,this.googleApiService=r,this.datePipe=n,this.formBuilder=o,this.commonService=s,this.ngZone=c,this.data=[],this.height=560,this.spreadsheetId=null,this.form=this.formBuilder.group({bank:["ACB",V.y.required],account:[null,V.y.required],range:["",ge],header:[!0],dateType:[2],time:[!1],year:[!1],column:this.formBuilder.group({date:[1,V.y.required],transaction:[2,V.y.required],content:[3,V.y.required],in:[5,V.y.required],out:[4,V.y.required]})}),this.sheetProperties=[],this.company="SEL",this.selBank={},this.selBank2=[],this._unsubscribeAll=new B.a}ngOnInit(){this.authService.windowSizeChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.height=e.height-64-12-12-54-8}),this.authService.changeScreen.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.height=e?this.authService.screenHeight-12-12-54-8:this.authService.screenHeight-64-12-12-54-8}),this.bankImportService.onDataChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{switch(this.company){case"DNL":this.account=this.bankImportService.account.filter(e=>[2,3].includes(e.owner)&&"ACB"==e.bank_info.code);break;case"SEL":this.account=this.bankImportService.account.filter(e=>[1].includes(e.owner));break;default:this.account=[]}console.log(this.account),this.type=this.bankImportService.type,this.bankType=this.bankImportService.bankType,this.customer=this.bankImportService.customer}),this.bankImportService.onDataBankChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.selBank=e}),this.bankImportService.onDataBank2Changed.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.selBank2=e}),this.googleApiService.onFileChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{if("INFO"==this.form.value.bank){let t={},i=this.form.value.account.id;e.map(e=>{e[6]&&(t[i+"-"+e[2]+"-in"]=e[6],t[i+"-"+e[3]+"-in"]=e[6])}),this.selBank2.map((e,i)=>{let a=e.bank_account+"-"+e.amount+"-"+this.datePipe.transform(e.date,"MM/dd/yyyy")+"-in";if(t[a]){let i={id:e.id,info:t[a]};e.info||this.bankImportService.updateSelBank(i,"in")}})}else e&&e.length>0&&this.form.valid?this.ngZone.run(()=>{this.data=this.bankImportService.createData(e,this.form.value,this.selBank),this.googleApiService.onFileDataChanged.next(this.data),this.googleApiService.stepChanged.next(1)}):this.data=[]}),this.googleApiService.onValidateForm.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{e&&this.validateFormDetail(!0)}),this.form.controls.bank.valueChanges.subscribe(e=>{let t=this.bankType.find(t=>t.bank==e);switch(this.company){case"DNL":this.account=this.bankImportService.account.filter(t=>[2,3].includes(t.owner)&&t.bank_info.code==e);break;case"SEL":this.account=this.bankImportService.account.filter(e=>[1].includes(e.owner));break;default:this.account=[]}1==this.account.length&&this.form.controls.account.setValue(this.account[0]),t&&(this.form.controls.header.setValue(t.header),this.form.controls.range.setValue(t.range),this.form.controls.dateType.setValue(t.dateType),this.form.controls.year.setValue(t.year),this.form.controls.time.setValue(t.time),this.form.get("column.date").setValue(t.column[0]),this.form.get("column.transaction").setValue(t.column[1]),this.form.get("column.content").setValue(t.column[2]),this.form.get("column.out").setValue(t.column[3]),this.form.get("column.in").setValue(t.column[4]),this.googleApiService.form=t,this.googleApiService.validForm=this.form.valid,this.googleApiService.onFormChanged.next(this.form.valid))}),this.form.valueChanges.subscribe(e=>{this.form.valid&&"string"!=typeof e.place?(this.googleApiService.form=e,this.googleApiService.validForm=this.form.valid,this.googleApiService.onFormChanged.next(!0)):this.googleApiService.onFormChanged.next(!1)}),this.form.get("column.date").valueChanges.pipe(Object(E.a)(this._unsubscribeAll),Object(J.a)(300),Object(G.a)()).subscribe(e=>{this.checkColumn("date",e)}),this.form.get("column.transaction").valueChanges.pipe(Object(E.a)(this._unsubscribeAll),Object(J.a)(300),Object(G.a)()).subscribe(e=>{this.checkColumn("transaction",e)}),this.form.get("column.content").valueChanges.pipe(Object(E.a)(this._unsubscribeAll),Object(J.a)(300),Object(G.a)()).subscribe(e=>{this.checkColumn("content",e)}),this.form.get("column.in").valueChanges.pipe(Object(E.a)(this._unsubscribeAll),Object(J.a)(300),Object(G.a)()).subscribe(e=>{this.checkColumn("in",e)}),this.form.get("column.out").valueChanges.pipe(Object(E.a)(this._unsubscribeAll),Object(J.a)(300),Object(G.a)()).subscribe(e=>{this.checkColumn("out",e)})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}ngAfterViewInit(){this.googleApiService.form&&setTimeout(()=>{console.log(this.googleApiService.form),this.form.patchValue(this.googleApiService.form)})}validateFormDetail(e){!0===e&&("string"==typeof this.form.value.place&&this.form.controls.place.setValue(null),this.markFormGroupTouched(this.form),this.googleApiService.validForm=!1,!0===this.form.valid&&(this.googleApiService.form=this.form.value,this.googleApiService.validForm=!0,this.googleApiService.onFormChanged.next(!0)))}markFormGroupTouched(e){Object.values(e.controls).forEach(e=>{e.markAsTouched(),e.controls&&this.markFormGroupTouched(e)})}checkColumn(e,t){let i=this.form.value.column;i.date==t&&"date"!=e&&this.form.get("column.date").setValue(null),i.transaction==t&&"transaction"!=e&&this.form.get("column.transaction").setValue(null),i.content==t&&"content"!=e&&this.form.get("column.content").setValue(null),i.in==t&&"in"!=e&&this.form.get("column.in").setValue(null),i.out==t&&"out"!=e&&this.form.get("column.out").setValue(null)}}return e.\u0275fac=function(t){return new(t||e)(T.Rb(a.g),T.Rb(a.a),T.Rb(N.a),T.Rb(M),T.Rb($.a),T.Rb(r.f),T.Rb(V.d),T.Rb(be.a),T.Rb(T.A))},e.\u0275cmp=T.Lb({type:e,selectors:[["bank-import-view"]],viewQuery:function(e,t){var i;1&e&&(T.Sc(ve,!0),T.Sc(xe,!0)),2&e&&(T.wc(i=T.gc())&&(t.templaceNgForm=i.first),T.wc(i=T.gc())&&(t.googleSheet=i.first))},decls:126,vars:24,consts:[["fxLayout","column","fxLayoutAlign","start start"],["name","form",1,"w-100-p",2,"overflow","auto",3,"formGroup","keydown.enter"],["formDirective","ngForm"],[1,"simple","table-format","w-100-p"],[1,"h-60"],["formControlName","bank"],[1,"font-size-12","mb-4",3,"value","checked"],["colspan","5"],["appearance","outline",1,"my-form-field"],["formControlName","account"],["style","font-size:12px",3,"value",4,"ngFor","ngForOf"],[1,"w-240"],["formGroupName","column"],["appearance","outline",1,"my-form-field",2,"width","110px"],["type","number","inputCheck","","aria-label","container","matInput","","formControlName","date","required","",2,"font-size","12px"],["type","number","inputCheck","","aria-label","date","matInput","","formControlName","transaction","required","",2,"font-size","12px"],["type","number","inputCheck","","aria-label","info","matInput","","formControlName","content","required","",2,"font-size","12px"],["type","number","inputCheck","","aria-label","info","matInput","","formControlName","in","required","",2,"font-size","12px"],["type","number","inputCheck","","aria-label","info","matInput","","formControlName","out","required","",2,"font-size","12px"],["fxLayout","row","fxLayoutAlign","start start"],["fxFlex","20",1,"p-4"],["fxFlex","80","formControlName","dateType","fxLayout","column","fxLayoutAlign","start"],["class","font-size-12 mb-4",3,"value","checked",4,"ngFor","ngForOf"],["fxFlex","80","formControlName","year","fxLayout","row","fxLayoutAlign","start"],[1,"font-size-12","mb-4",3,"value"],[1,"font-size-12","mb-4","ml-8",3,"value"],["fxFlex","80","formControlName","time",3,"checked"],[1,"font-size-12"],["appearance","outline","floatLabel","never",1,"my-form-field",2,"width","230px"],["matInput","","inputCheck","","formControlName","range","placeholder","Example: A1:C10 OR None","maxlength","11"],[1,"text-right"],[1,"mr-16"],["colspan","3"],["formControlName","header","fxLayout","row","fxLayoutAlign","start"],[3,"value","checked"],[1,"ml-4",3,"value"],[2,"font-size","12px",3,"value"],[4,"ngIf"]],template:function(e,t){1&e&&(T.Xb(0,"div",0),T.Xb(1,"form",1,2),T.fc("keydown.enter",(function(e){return"TEXTAREA"==e.target.tagName})),T.Xb(3,"table",3),T.Xb(4,"thead"),T.Xb(5,"tr",4),T.Xb(6,"th"),T.Lc(7,"Bank"),T.Wb(),T.Xb(8,"th"),T.Xb(9,"mat-radio-group",5),T.Xb(10,"mat-radio-button",6),T.Lc(11,"ACB"),T.Wb(),T.Wb(),T.Wb(),T.Xb(12,"th"),T.Xb(13,"mat-radio-group",5),T.Xb(14,"mat-radio-button",6),T.Lc(15,"SCB"),T.Wb(),T.Wb(),T.Wb(),T.Xb(16,"th"),T.Xb(17,"mat-radio-group",5),T.Xb(18,"mat-radio-button",6),T.Lc(19,"SHB"),T.Wb(),T.Wb(),T.Wb(),T.Xb(20,"th"),T.Xb(21,"mat-radio-group",5),T.Xb(22,"mat-radio-button",6),T.Lc(23,"INFO"),T.Wb(),T.Wb(),T.Wb(),T.Sb(24,"th"),T.Sb(25,"th"),T.Wb(),T.Xb(26,"tr"),T.Xb(27,"th"),T.Lc(28,"ACCOUNT"),T.Wb(),T.Xb(29,"th",7),T.Xb(30,"mat-form-field",8),T.Xb(31,"mat-select",9),T.Jc(32,Se,2,2,"mat-option",10),T.Wb(),T.Wb(),T.Wb(),T.Wb(),T.Xb(33,"tr",4),T.Xb(34,"th"),T.Lc(35,"SHEET"),T.Wb(),T.Xb(36,"th",11),T.Lc(37,"Column 1"),T.Wb(),T.Xb(38,"th"),T.Lc(39,"Column 2"),T.Wb(),T.Xb(40,"th"),T.Lc(41,"Column 3"),T.Wb(),T.Xb(42,"th"),T.Lc(43,"Column 4"),T.Wb(),T.Xb(44,"th"),T.Lc(45,"Column 5"),T.Wb(),T.Wb(),T.Wb(),T.Xb(46,"tbody"),T.Xb(47,"tr",4),T.Xb(48,"td"),T.Lc(49,"NAME"),T.Wb(),T.Xb(50,"td",11),T.Lc(51,"Date"),T.Wb(),T.Xb(52,"td"),T.Lc(53,"Transaction"),T.Wb(),T.Xb(54,"td"),T.Lc(55,"Content"),T.Wb(),T.Xb(56,"td"),T.Lc(57,"Out"),T.Wb(),T.Xb(58,"td"),T.Lc(59,"In"),T.Wb(),T.Wb(),T.Xb(60,"tr",12),T.Xb(61,"td"),T.Lc(62,"COLUMN"),T.Wb(),T.Xb(63,"td"),T.Xb(64,"mat-form-field",13),T.Sb(65,"input",14),T.Wb(),T.Wb(),T.Xb(66,"td"),T.Xb(67,"mat-form-field",13),T.Sb(68,"input",15),T.Wb(),T.Wb(),T.Xb(69,"td"),T.Xb(70,"mat-form-field",13),T.Sb(71,"input",16),T.Wb(),T.Wb(),T.Xb(72,"td"),T.Xb(73,"mat-form-field",13),T.Sb(74,"input",17),T.Wb(),T.Wb(),T.Xb(75,"td"),T.Xb(76,"mat-form-field",13),T.Sb(77,"input",18),T.Wb(),T.Wb(),T.Wb(),T.Xb(78,"tr"),T.Xb(79,"td"),T.Lc(80,"FORMAT"),T.Wb(),T.Xb(81,"td",11),T.Xb(82,"div",19),T.Xb(83,"span",20),T.Lc(84,"DATE:"),T.Wb(),T.Xb(85,"mat-radio-group",21),T.Jc(86,Ce,9,8,"mat-radio-button",22),T.Wb(),T.Wb(),T.Xb(87,"div",19),T.Xb(88,"span",20),T.Lc(89,"YEAR:"),T.Wb(),T.Xb(90,"mat-radio-group",23),T.Xb(91,"mat-radio-button",24),T.Lc(92,"yyyy"),T.Wb(),T.Xb(93,"mat-radio-button",25),T.Lc(94,"yy"),T.Wb(),T.Wb(),T.Wb(),T.Xb(95,"div",19),T.Xb(96,"span",20),T.Lc(97,"TIME:"),T.Wb(),T.Xb(98,"mat-checkbox",26),T.Xb(99,"span",27),T.Lc(100,"hh:mm"),T.Wb(),T.Wb(),T.Wb(),T.Wb(),T.Xb(101,"td"),T.Lc(102,"Text value"),T.Wb(),T.Xb(103,"td"),T.Lc(104,"Text value"),T.Wb(),T.Xb(105,"td"),T.Lc(106,"Number"),T.Wb(),T.Xb(107,"td"),T.Lc(108,"Number"),T.Wb(),T.Wb(),T.Xb(109,"tr"),T.Xb(110,"td"),T.Lc(111,"RANGE"),T.Wb(),T.Xb(112,"td"),T.Xb(113,"mat-form-field",28),T.Sb(114,"input",29),T.Wb(),T.Wb(),T.Xb(115,"td",30),T.Xb(116,"span",31),T.Lc(117,"HEADER"),T.Wb(),T.Wb(),T.Xb(118,"td",32),T.Xb(119,"mat-radio-group",33),T.Xb(120,"mat-radio-button",34),T.Lc(121,"None"),T.Wb(),T.Xb(122,"mat-radio-button",35),T.Lc(123,"First row"),T.Wb(),T.Wb(),T.Wb(),T.Wb(),T.Wb(),T.Wb(),T.Wb(),T.Lc(124),T.kc(125,"json"),T.Wb()),2&e&&(T.pc("@animateStagger",T.qc(23,Ae)),T.Db(1),T.Ic("height",t.height,"px"),T.pc("formGroup",t.form),T.Db(9),T.pc("value","ACB")("checked","ACB"==t.form.value.bank),T.Db(4),T.pc("value","SCB")("checked","SCB"==t.form.value.bank),T.Db(4),T.pc("value","SHB")("checked","SHB"==t.form.value.bank),T.Db(4),T.pc("value","INFO")("checked","INFO"==t.form.value.bank),T.Db(10),T.pc("ngForOf",t.account),T.Db(54),T.pc("ngForOf",t.type),T.Db(5),T.pc("value",!0),T.Db(2),T.pc("value",!1),T.Db(5),T.pc("checked",t.form.value.time),T.Db(22),T.pc("value",!1)("checked",!t.form.value.header),T.Db(2),T.pc("value",!0),T.Db(2),T.Nc(" ",T.lc(125,21,t.form.value),"\n"))},directives:[Y.d,Y.c,V.A,V.q,V.h,k.b,V.p,V.g,k.a,h.c,g.a,r.s,V.i,V.u,m.b,V.b,V.w,Y.b,S.a,V.k,ke.n,r.t],pipes:[r.k],styles:["bank-import-view .table-format{font-size:12px}bank-import-view .table-format td,bank-import-view .table-format th{padding:4px!important}bank-import-view .table-format .my-form-field{width:100%}bank-import-view .table-format .my-form-field .mat-form-field-wrapper{margin-bottom:-1.25em}bank-import-view .table-format .my-form-field .mat-form-field-infix{margin-top:-.75em}bank-import-view .table-format .my-form-field .mat-select-value-text{font-size:12px}bank-import-view cdk-virtual-scroll-viewport{width:100%}bank-import-view cdk-virtual-scroll-viewport .bank-import-table{font-size:12px}bank-import-view cdk-virtual-scroll-viewport .bank-import-table thead th{position:sticky;position:-webkit-sticky;top:0;background:#fff;z-index:10}bank-import-view cdk-virtual-scroll-viewport .bank-import-table td,bank-import-view cdk-virtual-scroll-viewport .bank-import-table th{padding:8px!important;font-size:12px}"],encapsulation:2,data:{animation:fe.a}}),e})();const De=function(e){return{"red-100-bg":e}};function Fe(e,t){if(1&e){const e=T.Yb();T.Xb(0,"tr",5),T.fc("click",(function(i){T.Bc(e);const a=t.$implicit;return T.jc().openFormBank.emit(a)})),T.Xb(1,"td"),T.Lc(2),T.Wb(),T.Xb(3,"td"),T.Lc(4),T.kc(5,"date"),T.Wb(),T.Xb(6,"td"),T.Lc(7),T.Wb(),T.Xb(8,"td",6),T.Lc(9),T.kc(10,"number"),T.Wb(),T.Xb(11,"td",6),T.Lc(12),T.kc(13,"number"),T.Wb(),T.Xb(14,"td"),T.Lc(15),T.Wb(),T.Xb(16,"td"),T.Lc(17),T.Wb(),T.Xb(18,"td",7),T.Lc(19),T.Wb(),T.Xb(20,"td"),T.Lc(21),T.Wb(),T.Xb(22,"td",8),T.Xb(23,"mat-icon",9),T.fc("click",(function(i){T.Bc(e);const a=t.$implicit,r=T.jc();return i.stopPropagation(),r.deleteItem(a)})),T.Lc(24,"delete"),T.Wb(),T.Wb(),T.Wb()}if(2&e){const e=t.$implicit,i=t.index;T.pc("ngClass",T.rc(22,De,""!=e.error||e.duplicate)),T.Db(2),T.Mc(i+1),T.Db(2),T.Mc(T.mc(5,13,e.date,"MM/dd/yyyy")),T.Db(3),T.Mc(e.transaction),T.Db(2),T.Mc(T.mc(10,16,e.in,"VND"==e.bank_account_info.currency_info.code?"1.0-0":"1.2-2")),T.Db(3),T.Mc(T.mc(13,19,e.out,"VND"==e.bank_account_info.currency_info.code?"1.0-0":"1.2-2")),T.Db(3),T.Mc(e.content),T.Db(2),T.Mc(1==e.status?"Valid":"Invalid"),T.Db(2),T.Pc("",e.bank_account_info.account," (",e.bank_account_info.bank_info.code,"-",e.bank_account_info.currency_info.code,")"),T.Db(2),T.Oc("",e.error,"",e.duplicate?"Error duplicate":"","")}}function Oe(e,t){if(1&e&&(T.Xb(0,"mat-option",19),T.Lc(1),T.Wb()),2&e){const e=t.$implicit,i=T.jc(2);T.pc("value",e),T.Db(1),T.Pc("",50*e+1," - ",50*(e+1)<i.bankImport.length?50*(e+1):i.bankImport.length," / ",i.bankImport.length,"")}}function _e(e,t){if(1&e){const e=T.Yb();T.Xb(0,"div"),T.Xb(1,"mat-button-toggle-group",10),T.Xb(2,"mat-button-toggle",11),T.fc("change",(function(t){return T.Bc(e),T.jc().changeItem(t)})),T.Xb(3,"mat-icon",12),T.Lc(4,"fast_rewind"),T.Wb(),T.Wb(),T.Xb(5,"mat-button-toggle"),T.Xb(6,"div",13),T.Xb(7,"mat-select",14),T.fc("ngModelChange",(function(t){return T.Bc(e),T.jc().onChangeSelect(t)})),T.Jc(8,Oe,2,4,"mat-option",15),T.Wb(),T.Wb(),T.Wb(),T.Xb(9,"mat-button-toggle",16),T.fc("change",(function(t){return T.Bc(e),T.jc().changeItem(t)})),T.Xb(10,"mat-icon",12),T.Lc(11,"fast_forward"),T.Wb(),T.Wb(),T.Wb(),T.Xb(12,"button",17),T.fc("click",(function(t){T.Bc(e);const i=T.jc();return i.saveImport(i.bankFilter)})),T.Lc(13,"Save"),T.Wb(),T.Xb(14,"button",18),T.fc("click",(function(t){return T.Bc(e),T.jc().goBack(!0)})),T.Xb(15,"span"),T.Lc(16,"New Import"),T.Wb(),T.Wb(),T.Xb(17,"button",18),T.fc("click",(function(t){return T.Bc(e),T.jc().goBack()})),T.Xb(18,"span"),T.Lc(19,"Back"),T.Wb(),T.Wb(),T.Wb()}if(2&e){const e=T.jc();T.Db(2),T.pc("disabled",0==e.selectedItem),T.Db(5),T.pc("ngModel",e.selectedItem),T.Db(1),T.pc("ngForOf",e.arrSelect),T.Db(1),T.pc("disabled",e.selectedItem==e.arrSelect.length-1),T.Db(3),T.pc("disabled",0==e.bankImport||e.check)}}const je=function(){return{value:"50"}};let Be=(()=>{class e{constructor(e,t,i,a,r,n,o,s){this._formBuilder=e,this.router=t,this.route=i,this.authService=a,this.datePipe=r,this.bankImportService=n,this.googleApiService=o,this._matDialog=s,this.height=560,this.selectedItem=0,this.bankFilter=[],this.arrSelect=[],this.formBankImport=this._formBuilder.group({bank_account:[null,V.y.required]}),this.check=!1,this._unsubscribeAll=new B.a}ngOnInit(){this.authService.windowSizeChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.height=e.height-64-12-12-54-8-72}),this.authService.changeScreen.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.height=e?this.authService.screenHeight-12-12-54-8-72:this.authService.screenHeight-64-12-12-54-8-72}),this.googleApiService.onFileDataChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.bankImport=e,this.arrSelect=[];let t=Math.round(this.bankImport.length/50);for(let i=0;i<=t;++i)this.arrSelect.push(i);this.bankFilter=[],this.selectedItem=0,this.check=!1,this.bankImport.map((e,t)=>{t>=50*this.selectedItem&&t<=50*(this.selectedItem+1)-1&&(this.bankFilter.push(e),(e.error||e.duplicate)&&(this.check=!0))})}),this.bankImportService.onDataChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.type=this.bankImportService.type,this.bankType=this.bankImportService.bankType}),this.bankImportService.onDataBankChanged.pipe(Object(E.a)(this._unsubscribeAll)).subscribe(e=>{this.selBank=e})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}onChangeSelect(e){this.selectedItem=e,this.bankFilter=[],this.check=!1,this.bankImport.map((e,t)=>{t>=50*this.selectedItem&&t<=50*(this.selectedItem+1)-1&&(this.bankFilter.push(e),e.error&&(this.check=!0))})}changeItem(e){this.selectedItem=this.selectedItem+parseInt(e.value),this.bankFilter=[],this.check=!1,this.bankImport.map((e,t)=>{t>=50*this.selectedItem&&t<=50*(this.selectedItem+1)-1&&(this.bankFilter.push(e),e.error&&(this.check=!0))})}saveImport(e){let t=JSON.parse(JSON.stringify(e)),i="";t.map(e=>{switch(e.date=this.datePipe.transform(e.date,"yyyy-MM-dd"),e.update_by=this.authService.user,i){case"in":e.out&&(i="all");break;case"out":e.in&&(i="all");break;case"":e.in&&(i="in"),e.out&&(i="out")}}),this.authService.onRequestChanged.next(!0),this.bankImportService.saveSelImport(t).then(t=>{this.authService.onRequestChanged.next(!1),console.log(t),("in"==i||"out"==i)&&t.insertId>0?(e.map(e=>e.error="save success"),this.check=!0,this.bankImportService.getBank()):"all"==i&&t.bankIn.insertId>0&&t.bankOut.insertId>0?(e.map(e=>e.error="save success"),this.check=!0,this.bankImportService.getBank()):(alert("ERROR"),console.error(t))}).catch(e=>{this.authService.onRequestChanged.next(!1),alert("ERROR"),console.error(e)})}resetTable(){this.googleApiService.onFileDataChanged.next([])}deleteItem(e){let t=this.bankImport.indexOf(e);this.bankImport.splice(t,1),this.googleApiService.onFileDataChanged.next(this.bankImport)}getCheck(){let e=!1;return this.bankImport.map(t=>{(t.error||t.duplicate)&&(e=!0)}),e}goBack(e){e&&(this.googleApiService.form=null),this.googleApiService.stepChanged.next(0)}}return e.\u0275fac=function(t){return new(t||e)(T.Rb(V.d),T.Rb(a.g),T.Rb(a.a),T.Rb(N.a),T.Rb(r.f),T.Rb(M),T.Rb($.a),T.Rb(v.b))},e.\u0275cmp=T.Lb({type:e,selectors:[["bank-import-table"]],viewQuery:function(e,t){var i;1&e&&T.Sc(L.e,!0),2&e&&T.wc(i=T.gc())&&(t.viewPort=i.first)},decls:27,vars:6,consts:[[1,"w-100-p","table-content"],[1,"simple","bankImport-list-table"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"p-8","w-100-p","mt-8"],[4,"ngIf"],[3,"ngClass","click"],[1,"text-right","pr-8"],[1,"w-80"],[1,"w-40","p-0"],["color","warn",1,"cursor-pointer",3,"click"],[1,"mr-8"],["value","-1",3,"disabled","change"],["color","accent"],[1,"w-140"],["required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["value","1",3,"disabled","change"],["mat-raised-button","","type","button","color","accent",1,"mt-8","mr-8",3,"disabled","click"],["type","button","mat-raised-button","","color","accent",1,"ml-8",3,"click"],[3,"value"]],template:function(e,t){1&e&&(T.Xb(0,"div",0),T.Xb(1,"table",1),T.Xb(2,"thead"),T.Xb(3,"tr"),T.Xb(4,"th"),T.Lc(5,"No"),T.Wb(),T.Xb(6,"th"),T.Lc(7,"Date"),T.Wb(),T.Xb(8,"th"),T.Lc(9,"Transaction"),T.Wb(),T.Xb(10,"th"),T.Lc(11,"Amount In"),T.Wb(),T.Xb(12,"th"),T.Lc(13,"Amount Out"),T.Wb(),T.Xb(14,"th"),T.Lc(15,"Content"),T.Wb(),T.Xb(16,"th"),T.Lc(17,"Status"),T.Wb(),T.Xb(18,"th"),T.Lc(19,"Account"),T.Wb(),T.Xb(20,"th"),T.Lc(21,"Error"),T.Wb(),T.Sb(22,"th"),T.Wb(),T.Wb(),T.Xb(23,"tbody"),T.Jc(24,Fe,25,24,"tr",2),T.Wb(),T.Wb(),T.Wb(),T.Xb(25,"div",3),T.Jc(26,_e,20,5,"div",4),T.Wb()),2&e&&(T.Ic("height",t.height,"px"),T.pc("@animateStagger",T.qc(5,je)),T.Db(24),T.pc("ngForOf",t.bankFilter),T.Db(2),T.pc("ngIf",t.bankImport.length>0))},directives:[r.s,r.t,r.q,Q.a,u.a,l.b,l.a,g.a,V.w,V.p,V.s,b.b,ke.n],pipes:[r.f,r.g],styles:["bank-import-table .table-content{overflow:auto}bank-import-table .table-content .bankImport-list-table{width:100%}bank-import-table .table-content .bankImport-list-table td,bank-import-table .table-content .bankImport-list-table th{padding:8px;font-size:12px}bank-import-table .table-content .bankImport-list-table thead th{position:sticky;position:-webkit-sticky;top:0;background:#fff;z-index:10}bank-import-table .table-content .bankImport-list-table tfoot td{position:sticky;position:-webkit-sticky;bottom:0;background:#fff;z-index:10}bank-import-table .table-content .bankImport-list-table tr:hover{background:#e1f5fe}bank-import-table .table-content .bankImport-list-table tr:active{background:#81d4fa}"],encapsulation:2,data:{animation:fe.a}}),e})();i.d(t,"BankImportModule",(function(){return Re}));const Te=[{path:"",component:me,resolve:{data:M,google:$.a},children:[{path:"view",component:Le},{path:"table",component:Be}]}];let Re=(()=>{class e{}return e.\u0275mod=T.Pb({type:e}),e.\u0275inj=T.Ob({factory:function(t){return new(t||e)},providers:[M],imports:[[a.k.forChild(Te),r.c,o.b,s.b,c.c,b.c,l.c,p.b,h.e,u.b,d.b,m.c,f.c,g.b,k.c,v.e,x.b,S.b,w.b,y.d,I.e,X.b,W.b,C.b,A.k,L.g,D.b,F.c,O.a,_.f,n.a]]}),e})()}}]);